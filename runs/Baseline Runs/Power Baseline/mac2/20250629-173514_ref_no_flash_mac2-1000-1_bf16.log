/Users/ianreitsma/projects/orchard/orchard-env/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
`loss_type=None` was set in the config but it is unrecognised.Using the default loss: `ForCausalLMLoss`.
[orchard][ref_no_flash_mac2-1_bf16] step 1/1000 ( 0.1%)  wall=   1.9s  tps≈  527.5
[orchard][ref_no_flash_mac2-1_bf16] step 8/1000 ( 0.8%)  wall=  12.5s  tps≈  654.8
[orchard][ref_no_flash_mac2-1_bf16] step 15/1000 ( 1.5%)  wall=  22.6s  tps≈  678.7
[orchard][ref_no_flash_mac2-1_bf16] step 22/1000 ( 2.2%)  wall=  32.7s  tps≈  689.2
[orchard][ref_no_flash_mac2-1_bf16] step 29/1000 ( 2.9%)  wall=  42.9s  tps≈  692.5
[orchard][ref_no_flash_mac2-1_bf16] step 36/1000 ( 3.6%)  wall=  53.0s  tps≈  695.1
[orchard][ref_no_flash_mac2-1_bf16] step 43/1000 ( 4.3%)  wall=  63.1s  tps≈  697.6
[orchard][ref_no_flash_mac2-1_bf16] step 50/1000 ( 5.0%)  wall=  73.3s  tps≈  698.3
[orchard][ref_no_flash_mac2-1_bf16] step 57/1000 ( 5.7%)  wall=  83.5s  tps≈  698.9
[orchard][ref_no_flash_mac2-1_bf16] step 64/1000 ( 6.4%)  wall=  93.7s  tps≈  699.1
[orchard][ref_no_flash_mac2-1_bf16] step 71/1000 ( 7.1%)  wall= 103.9s  tps≈  699.8
[orchard][ref_no_flash_mac2-1_bf16] step 78/1000 ( 7.8%)  wall= 114.1s  tps≈  700.3
[orchard][ref_no_flash_mac2-1_bf16] step 85/1000 ( 8.5%)  wall= 124.1s  tps≈  701.4
[orchard][ref_no_flash_mac2-1_bf16] step 92/1000 ( 9.2%)  wall= 134.2s  tps≈  702.1
[orchard][ref_no_flash_mac2-1_bf16] step 99/1000 ( 9.9%)  wall= 144.3s  tps≈  702.5
[orchard][ref_no_flash_mac2-1_bf16] step 106/1000 (10.6%)  wall= 154.5s  tps≈  702.7
[orchard][ref_no_flash_mac2-1_bf16] step 113/1000 (11.3%)  wall= 164.5s  tps≈  703.3
[orchard][ref_no_flash_mac2-1_bf16] step 120/1000 (12.0%)  wall= 174.9s  tps≈  702.7
[orchard][ref_no_flash_mac2-1_bf16] step 127/1000 (12.7%)  wall= 185.2s  tps≈  702.2
[orchard][ref_no_flash_mac2-1_bf16] step 134/1000 (13.4%)  wall= 195.9s  tps≈  700.3
[orchard][ref_no_flash_mac2-1_bf16] step 141/1000 (14.1%)  wall= 206.7s  tps≈  698.5
[orchard][ref_no_flash_mac2-1_bf16] step 148/1000 (14.8%)  wall= 217.1s  tps≈  698.1
[orchard][ref_no_flash_mac2-1_bf16] step 155/1000 (15.5%)  wall= 227.4s  tps≈  697.9
[orchard][ref_no_flash_mac2-1_bf16] step 162/1000 (16.2%)  wall= 238.1s  tps≈  696.8
[orchard][ref_no_flash_mac2-1_bf16] step 169/1000 (16.9%)  wall= 248.1s  tps≈  697.5
[orchard][ref_no_flash_mac2-1_bf16] step 176/1000 (17.6%)  wall= 258.5s  tps≈  697.1
[orchard][ref_no_flash_mac2-1_bf16] step 183/1000 (18.3%)  wall= 269.7s  tps≈  694.7
[orchard][ref_no_flash_mac2-1_bf16] step 190/1000 (19.0%)  wall= 280.6s  tps≈  693.3
[orchard][ref_no_flash_mac2-1_bf16] step 197/1000 (19.7%)  wall= 291.2s  tps≈  692.8
[orchard][ref_no_flash_mac2-1_bf16] step 204/1000 (20.4%)  wall= 301.7s  tps≈  692.4
[orchard][ref_no_flash_mac2-1_bf16] step 211/1000 (21.1%)  wall= 313.0s  tps≈  690.3
[orchard][ref_no_flash_mac2-1_bf16] step 217/1000 (21.7%)  wall= 323.1s  tps≈  687.8
[orchard][ref_no_flash_mac2-1_bf16] step 224/1000 (22.4%)  wall= 333.9s  tps≈  687.0
[orchard][ref_no_flash_mac2-1_bf16] step 231/1000 (23.1%)  wall= 344.9s  tps≈  685.9
[orchard][ref_no_flash_mac2-1_bf16] step 238/1000 (23.8%)  wall= 355.5s  tps≈  685.6
[orchard][ref_no_flash_mac2-1_bf16] step 245/1000 (24.5%)  wall= 366.0s  tps≈  685.4
[orchard][ref_no_flash_mac2-1_bf16] step 252/1000 (25.2%)  wall= 377.4s  tps≈  683.8
[orchard][ref_no_flash_mac2-1_bf16] step 259/1000 (25.9%)  wall= 388.4s  tps≈  682.8
[orchard][ref_no_flash_mac2-1_bf16] step 266/1000 (26.6%)  wall= 399.0s  tps≈  682.7
[orchard][ref_no_flash_mac2-1_bf16] step 273/1000 (27.3%)  wall= 409.4s  tps≈  682.9
[orchard][ref_no_flash_mac2-1_bf16] step 280/1000 (28.0%)  wall= 419.9s  tps≈  682.8
[orchard][ref_no_flash_mac2-1_bf16] step 287/1000 (28.7%)  wall= 430.9s  tps≈  682.0
[orchard][ref_no_flash_mac2-1_bf16] step 294/1000 (29.4%)  wall= 441.6s  tps≈  681.7
[orchard][ref_no_flash_mac2-1_bf16] step 301/1000 (30.1%)  wall= 452.2s  tps≈  681.6
[orchard][ref_no_flash_mac2-1_bf16] step 308/1000 (30.8%)  wall= 463.0s  tps≈  681.1
[orchard][ref_no_flash_mac2-1_bf16] step 315/1000 (31.5%)  wall= 473.6s  tps≈  681.1
[orchard][ref_no_flash_mac2-1_bf16] step 322/1000 (32.2%)  wall= 484.7s  tps≈  680.3
[orchard][ref_no_flash_mac2-1_bf16] step 329/1000 (32.9%)  wall= 495.6s  tps≈  679.7
[orchard][ref_no_flash_mac2-1_bf16] step 335/1000 (33.5%)  wall= 506.7s  tps≈  677.0
[orchard][ref_no_flash_mac2-1_bf16] step 342/1000 (34.2%)  wall= 517.7s  tps≈  676.4
[orchard][ref_no_flash_mac2-1_bf16] step 349/1000 (34.9%)  wall= 528.5s  tps≈  676.3
[orchard][ref_no_flash_mac2-1_bf16] step 356/1000 (35.6%)  wall= 539.2s  tps≈  676.1
[orchard][ref_no_flash_mac2-1_bf16] step 363/1000 (36.3%)  wall= 549.4s  tps≈  676.6
[orchard][ref_no_flash_mac2-1_bf16] step 370/1000 (37.0%)  wall= 559.6s  tps≈  677.0
[orchard][ref_no_flash_mac2-1_bf16] step 377/1000 (37.7%)  wall= 570.0s  tps≈  677.2
[orchard][ref_no_flash_mac2-1_bf16] step 384/1000 (38.4%)  wall= 581.0s  tps≈  676.8
[orchard][ref_no_flash_mac2-1_bf16] step 391/1000 (39.1%)  wall= 591.9s  tps≈  676.4
[orchard][ref_no_flash_mac2-1_bf16] step 398/1000 (39.8%)  wall= 603.3s  tps≈  675.6
[orchard][ref_no_flash_mac2-1_bf16] step 405/1000 (40.5%)  wall= 614.6s  tps≈  674.8
[orchard][ref_no_flash_mac2-1_bf16] step 411/1000 (41.1%)  wall= 624.8s  tps≈  673.6
[orchard][ref_no_flash_mac2-1_bf16] step 418/1000 (41.8%)  wall= 636.5s  tps≈  672.4
[orchard][ref_no_flash_mac2-1_bf16] step 424/1000 (42.4%)  wall= 648.2s  tps≈  669.8
[orchard][ref_no_flash_mac2-1_bf16] step 431/1000 (43.1%)  wall= 658.8s  tps≈  670.0
[orchard][ref_no_flash_mac2-1_bf16] step 438/1000 (43.8%)  wall= 669.5s  tps≈  670.0
[orchard][ref_no_flash_mac2-1_bf16] step 445/1000 (44.5%)  wall= 680.0s  tps≈  670.1
[orchard][ref_no_flash_mac2-1_bf16] step 452/1000 (45.2%)  wall= 690.7s  tps≈  670.1
[orchard][ref_no_flash_mac2-1_bf16] step 459/1000 (45.9%)  wall= 701.1s  tps≈  670.4
[orchard][ref_no_flash_mac2-1_bf16] step 466/1000 (46.6%)  wall= 712.2s  tps≈  670.0
[orchard][ref_no_flash_mac2-1_bf16] step 473/1000 (47.3%)  wall= 723.0s  tps≈  669.9
[orchard][ref_no_flash_mac2-1_bf16] step 480/1000 (48.0%)  wall= 733.8s  tps≈  669.8
[orchard][ref_no_flash_mac2-1_bf16] step 487/1000 (48.7%)  wall= 744.4s  tps≈  669.9
[orchard][ref_no_flash_mac2-1_bf16] step 494/1000 (49.4%)  wall= 756.1s  tps≈  669.1
[orchard][ref_no_flash_mac2-1_bf16] step 500/1000 (50.0%)  wall= 767.1s  tps≈  667.4
[orchard][ref_no_flash_mac2-1_bf16] step 507/1000 (50.7%)  wall= 778.3s  tps≈  667.0
[orchard][ref_no_flash_mac2-1_bf16] step 514/1000 (51.4%)  wall= 789.2s  tps≈  666.9
[orchard][ref_no_flash_mac2-1_bf16] step 521/1000 (52.1%)  wall= 800.5s  tps≈  666.5
[orchard][ref_no_flash_mac2-1_bf16] step 527/1000 (52.7%)  wall= 811.0s  tps≈  665.4
[orchard][ref_no_flash_mac2-1_bf16] step 533/1000 (53.3%)  wall= 821.6s  tps≈  664.3
[orchard][ref_no_flash_mac2-1_bf16] step 540/1000 (54.0%)  wall= 832.7s  tps≈  664.0
[orchard][ref_no_flash_mac2-1_bf16] step 545/1000 (54.5%)  wall= 843.0s  tps≈  662.0
[orchard][ref_no_flash_mac2-1_bf16] step 552/1000 (55.2%)  wall= 854.0s  tps≈  661.9
[orchard][ref_no_flash_mac2-1_bf16] step 559/1000 (55.9%)  wall= 864.6s  tps≈  662.1
[orchard][ref_no_flash_mac2-1_bf16] step 566/1000 (56.6%)  wall= 875.8s  tps≈  661.8
[orchard][ref_no_flash_mac2-1_bf16] step 573/1000 (57.3%)  wall= 886.5s  tps≈  661.9
[orchard][ref_no_flash_mac2-1_bf16] step 580/1000 (58.0%)  wall= 896.9s  tps≈  662.2
[orchard][ref_no_flash_mac2-1_bf16] step 587/1000 (58.7%)  wall= 907.4s  tps≈  662.4
[orchard][ref_no_flash_mac2-1_bf16] step 594/1000 (59.4%)  wall= 918.0s  tps≈  662.6
[orchard][ref_no_flash_mac2-1_bf16] step 601/1000 (60.1%)  wall= 928.2s  tps≈  663.0
[orchard][ref_no_flash_mac2-1_bf16] step 608/1000 (60.8%)  wall= 938.7s  tps≈  663.3
[orchard][ref_no_flash_mac2-1_bf16] step 615/1000 (61.5%)  wall= 949.7s  tps≈  663.1
[orchard][ref_no_flash_mac2-1_bf16] step 621/1000 (62.1%)  wall= 959.7s  tps≈  662.6
[orchard][ref_no_flash_mac2-1_bf16] step 628/1000 (62.8%)  wall= 971.5s  tps≈  662.0
[orchard][ref_no_flash_mac2-1_bf16] step 634/1000 (63.4%)  wall= 982.7s  tps≈  660.7
[orchard][ref_no_flash_mac2-1_bf16] step 640/1000 (64.0%)  wall= 993.7s  tps≈  659.5
[orchard][ref_no_flash_mac2-1_bf16] step 647/1000 (64.7%)  wall=1004.4s  tps≈  659.6
[orchard][ref_no_flash_mac2-1_bf16] step 654/1000 (65.4%)  wall=1015.0s  tps≈  659.8
[orchard][ref_no_flash_mac2-1_bf16] step 661/1000 (66.1%)  wall=1025.9s  tps≈  659.8
[orchard][ref_no_flash_mac2-1_bf16] step 668/1000 (66.8%)  wall=1036.9s  tps≈  659.7
[orchard][ref_no_flash_mac2-1_bf16] step 675/1000 (67.5%)  wall=1047.3s  tps≈  660.0
[orchard][ref_no_flash_mac2-1_bf16] step 682/1000 (68.2%)  wall=1058.0s  tps≈  660.1
[orchard][ref_no_flash_mac2-1_bf16] step 689/1000 (68.9%)  wall=1068.7s  tps≈  660.2
[orchard][ref_no_flash_mac2-1_bf16] step 696/1000 (69.6%)  wall=1079.6s  tps≈  660.2
[orchard][ref_no_flash_mac2-1_bf16] step 703/1000 (70.3%)  wall=1090.4s  tps≈  660.2
[orchard][ref_no_flash_mac2-1_bf16] step 710/1000 (71.0%)  wall=1101.8s  tps≈  659.9
[orchard][ref_no_flash_mac2-1_bf16] step 717/1000 (71.7%)  wall=1112.5s  tps≈  660.0
[orchard][ref_no_flash_mac2-1_bf16] step 724/1000 (72.4%)  wall=1123.3s  tps≈  660.0
[orchard][ref_no_flash_mac2-1_bf16] step 731/1000 (73.1%)  wall=1133.8s  tps≈  660.2
[orchard][ref_no_flash_mac2-1_bf16] step 738/1000 (73.8%)  wall=1144.5s  tps≈  660.3
[orchard][ref_no_flash_mac2-1_bf16] step 745/1000 (74.5%)  wall=1155.1s  tps≈  660.4
[orchard][ref_no_flash_mac2-1_bf16] step 752/1000 (75.2%)  wall=1165.5s  tps≈  660.7
[orchard][ref_no_flash_mac2-1_bf16] step 759/1000 (75.9%)  wall=1175.9s  tps≈  661.0
[orchard][ref_no_flash_mac2-1_bf16] step 766/1000 (76.6%)  wall=1186.6s  tps≈  661.0
[orchard][ref_no_flash_mac2-1_bf16] step 773/1000 (77.3%)  wall=1197.3s  tps≈  661.1
[orchard][ref_no_flash_mac2-1_bf16] step 780/1000 (78.0%)  wall=1208.4s  tps≈  661.0
[orchard][ref_no_flash_mac2-1_bf16] step 787/1000 (78.7%)  wall=1219.4s  tps≈  660.9
[orchard][ref_no_flash_mac2-1_bf16] step 794/1000 (79.4%)  wall=1231.2s  tps≈  660.4
[orchard][ref_no_flash_mac2-1_bf16] step 800/1000 (80.0%)  wall=1241.8s  tps≈  659.7
[orchard][ref_no_flash_mac2-1_bf16] step 806/1000 (80.6%)  wall=1253.1s  tps≈  658.6
[orchard][ref_no_flash_mac2-1_bf16] step 812/1000 (81.2%)  wall=1264.8s  tps≈  657.4
[orchard][ref_no_flash_mac2-1_bf16] step 818/1000 (81.8%)  wall=1275.9s  tps≈  656.5
[orchard][ref_no_flash_mac2-1_bf16] step 825/1000 (82.5%)  wall=1287.4s  tps≈  656.2
[orchard][ref_no_flash_mac2-1_bf16] step 832/1000 (83.2%)  wall=1298.7s  tps≈  656.0
[orchard][ref_no_flash_mac2-1_bf16] step 839/1000 (83.9%)  wall=1310.2s  tps≈  655.7
[orchard][ref_no_flash_mac2-1_bf16] step 846/1000 (84.6%)  wall=1321.4s  tps≈  655.6
[orchard][ref_no_flash_mac2-1_bf16] step 853/1000 (85.3%)  wall=1332.2s  tps≈  655.7
[orchard][ref_no_flash_mac2-1_bf16] step 860/1000 (86.0%)  wall=1343.2s  tps≈  655.6
[orchard][ref_no_flash_mac2-1_bf16] step 867/1000 (86.7%)  wall=1354.3s  tps≈  655.6
[orchard][ref_no_flash_mac2-1_bf16] step 874/1000 (87.4%)  wall=1364.8s  tps≈  655.8
[orchard][ref_no_flash_mac2-1_bf16] step 881/1000 (88.1%)  wall=1375.4s  tps≈  655.9
[orchard][ref_no_flash_mac2-1_bf16] step 888/1000 (88.8%)  wall=1385.6s  tps≈  656.3
[orchard][ref_no_flash_mac2-1_bf16] step 895/1000 (89.5%)  wall=1396.1s  tps≈  656.4
[orchard][ref_no_flash_mac2-1_bf16] step 902/1000 (90.2%)  wall=1406.5s  tps≈  656.7
[orchard][ref_no_flash_mac2-1_bf16] step 909/1000 (90.9%)  wall=1417.9s  tps≈  656.5
[orchard][ref_no_flash_mac2-1_bf16] step 916/1000 (91.6%)  wall=1428.1s  tps≈  656.8
[orchard][ref_no_flash_mac2-1_bf16] step 923/1000 (92.3%)  wall=1439.3s  tps≈  656.7
[orchard][ref_no_flash_mac2-1_bf16] step 930/1000 (93.0%)  wall=1450.1s  tps≈  656.7
[orchard][ref_no_flash_mac2-1_bf16] step 937/1000 (93.7%)  wall=1460.7s  tps≈  656.8
[orchard][ref_no_flash_mac2-1_bf16] step 944/1000 (94.4%)  wall=1472.0s  tps≈  656.7
[orchard][ref_no_flash_mac2-1_bf16] step 951/1000 (95.1%)  wall=1482.9s  tps≈  656.7
[orchard][ref_no_flash_mac2-1_bf16] step 958/1000 (95.8%)  wall=1493.7s  tps≈  656.8
[orchard][ref_no_flash_mac2-1_bf16] step 965/1000 (96.5%)  wall=1504.2s  tps≈  656.9
[orchard][ref_no_flash_mac2-1_bf16] step 972/1000 (97.2%)  wall=1514.9s  tps≈  657.0
[orchard][ref_no_flash_mac2-1_bf16] step 979/1000 (97.9%)  wall=1525.9s  tps≈  657.0
[orchard][ref_no_flash_mac2-1_bf16] step 986/1000 (98.6%)  wall=1537.3s  tps≈  656.8
[orchard][ref_no_flash_mac2-1_bf16] step 992/1000 (99.2%)  wall=1547.5s  tps≈  656.4
[orchard][ref_no_flash_mac2-1_bf16] step 998/1000 (99.8%)  wall=1558.6s  tps≈  655.7
[orchard][ref_no_flash_mac2-1_bf16] step 1000/1000 (100.0%)  wall=1562.9s  tps≈  655.2
JSON:{"schema": "orchard_bench_v1", "tag": "ref_no_flash_mac2-1_bf16", "commit": "34969e4", "dataset_sha": "57f3eb280cfe78d8cebe3aa76d7416607845416e22464dd9709ccb487f8d7b92", "batch": 2, "seq": 512, "micro_steps": 1000, "total_tokens": 1024000, "throughput_tps": 655.0506952488932, "tokenize_s": 7.7588, "copy_s": 16.163, "copy_mb_s": 0.51, "train_s": 0.0, "host_to_gpu_mb": 8.19, "avg_loss_stub": 0.574789007376181, "max_grad": 159.0, "dtype": "torch.bfloat16", "bf16": true, "flash": {"enabled": false}, "metal_ver": "unknown", "seed": 42, "timeline": [], "avg_gpu_w": 5475.036750483559, "avg_gpu_temp": null}
