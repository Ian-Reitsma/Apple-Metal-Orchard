/Users/ianreitsma/projects/orchard/orchard-env/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
`loss_type=None` was set in the config but it is unrecognised.Using the default loss: `ForCausalLMLoss`.
[orchard][ref_no_flash_mac2-3_bf16] step 1/1000 ( 0.1%)  wall=   1.9s  tps≈  534.4
[orchard][ref_no_flash_mac2-3_bf16] step 8/1000 ( 0.8%)  wall=  12.2s  tps≈  669.4
[orchard][ref_no_flash_mac2-3_bf16] step 16/1000 ( 1.6%)  wall=  23.6s  tps≈  692.8
[orchard][ref_no_flash_mac2-3_bf16] step 23/1000 ( 2.3%)  wall=  34.0s  tps≈  691.9
[orchard][ref_no_flash_mac2-3_bf16] step 30/1000 ( 3.0%)  wall=  44.2s  tps≈  694.3
[orchard][ref_no_flash_mac2-3_bf16] step 37/1000 ( 3.7%)  wall=  54.3s  tps≈  698.4
[orchard][ref_no_flash_mac2-3_bf16] step 45/1000 ( 4.5%)  wall=  65.5s  tps≈  703.1
[orchard][ref_no_flash_mac2-3_bf16] step 52/1000 ( 5.2%)  wall=  75.7s  tps≈  703.3
[orchard][ref_no_flash_mac2-3_bf16] step 59/1000 ( 5.9%)  wall=  85.7s  tps≈  704.6
[orchard][ref_no_flash_mac2-3_bf16] step 67/1000 ( 6.7%)  wall=  97.1s  tps≈  706.3
[orchard][ref_no_flash_mac2-3_bf16] step 75/1000 ( 7.5%)  wall= 108.5s  tps≈  707.7
[orchard][ref_no_flash_mac2-3_bf16] step 82/1000 ( 8.2%)  wall= 118.6s  tps≈  707.9
[orchard][ref_no_flash_mac2-3_bf16] step 89/1000 ( 8.9%)  wall= 128.7s  tps≈  708.2
[orchard][ref_no_flash_mac2-3_bf16] step 96/1000 ( 9.6%)  wall= 138.9s  tps≈  707.7
[orchard][ref_no_flash_mac2-3_bf16] step 103/1000 (10.3%)  wall= 148.9s  tps≈  708.2
[orchard][ref_no_flash_mac2-3_bf16] step 111/1000 (11.1%)  wall= 160.3s  tps≈  709.0
[orchard][ref_no_flash_mac2-3_bf16] step 118/1000 (11.8%)  wall= 170.5s  tps≈  708.5
[orchard][ref_no_flash_mac2-3_bf16] step 125/1000 (12.5%)  wall= 180.6s  tps≈  708.8
[orchard][ref_no_flash_mac2-3_bf16] step 132/1000 (13.2%)  wall= 190.6s  tps≈  709.2
[orchard][ref_no_flash_mac2-3_bf16] step 139/1000 (13.9%)  wall= 200.6s  tps≈  709.4
[orchard][ref_no_flash_mac2-3_bf16] step 146/1000 (14.6%)  wall= 210.6s  tps≈  709.7
[orchard][ref_no_flash_mac2-3_bf16] step 154/1000 (15.4%)  wall= 222.0s  tps≈  710.2
[orchard][ref_no_flash_mac2-3_bf16] step 161/1000 (16.1%)  wall= 232.0s  tps≈  710.5
[orchard][ref_no_flash_mac2-3_bf16] step 169/1000 (16.9%)  wall= 243.5s  tps≈  710.8
[orchard][ref_no_flash_mac2-3_bf16] step 176/1000 (17.6%)  wall= 253.8s  tps≈  710.0
[orchard][ref_no_flash_mac2-3_bf16] step 183/1000 (18.3%)  wall= 264.5s  tps≈  708.6
[orchard][ref_no_flash_mac2-3_bf16] step 190/1000 (19.0%)  wall= 275.1s  tps≈  707.3
[orchard][ref_no_flash_mac2-3_bf16] step 197/1000 (19.7%)  wall= 285.5s  tps≈  706.7
[orchard][ref_no_flash_mac2-3_bf16] step 205/1000 (20.5%)  wall= 296.8s  tps≈  707.2
[orchard][ref_no_flash_mac2-3_bf16] step 211/1000 (21.1%)  wall= 307.2s  tps≈  703.3
[orchard][ref_no_flash_mac2-3_bf16] step 218/1000 (21.8%)  wall= 318.6s  tps≈  700.7
[orchard][ref_no_flash_mac2-3_bf16] step 225/1000 (22.5%)  wall= 329.8s  tps≈  698.7
[orchard][ref_no_flash_mac2-3_bf16] step 232/1000 (23.2%)  wall= 341.2s  tps≈  696.2
[orchard][ref_no_flash_mac2-3_bf16] step 238/1000 (23.8%)  wall= 351.5s  tps≈  693.4
[orchard][ref_no_flash_mac2-3_bf16] step 244/1000 (24.4%)  wall= 361.8s  tps≈  690.5
[orchard][ref_no_flash_mac2-3_bf16] step 251/1000 (25.1%)  wall= 373.6s  tps≈  688.0
[orchard][ref_no_flash_mac2-3_bf16] step 257/1000 (25.7%)  wall= 384.2s  tps≈  684.9
[orchard][ref_no_flash_mac2-3_bf16] step 264/1000 (26.4%)  wall= 394.5s  tps≈  685.2
[orchard][ref_no_flash_mac2-3_bf16] step 271/1000 (27.1%)  wall= 405.3s  tps≈  684.7
[orchard][ref_no_flash_mac2-3_bf16] step 278/1000 (27.8%)  wall= 415.8s  tps≈  684.7
[orchard][ref_no_flash_mac2-3_bf16] step 285/1000 (28.5%)  wall= 426.6s  tps≈  684.1
[orchard][ref_no_flash_mac2-3_bf16] step 292/1000 (29.2%)  wall= 436.9s  tps≈  684.4
[orchard][ref_no_flash_mac2-3_bf16] step 299/1000 (29.9%)  wall= 448.1s  tps≈  683.3
[orchard][ref_no_flash_mac2-3_bf16] step 306/1000 (30.6%)  wall= 458.9s  tps≈  682.8
[orchard][ref_no_flash_mac2-3_bf16] step 313/1000 (31.3%)  wall= 469.4s  tps≈  682.9
[orchard][ref_no_flash_mac2-3_bf16] step 320/1000 (32.0%)  wall= 479.8s  tps≈  682.9
[orchard][ref_no_flash_mac2-3_bf16] step 327/1000 (32.7%)  wall= 490.0s  tps≈  683.4
[orchard][ref_no_flash_mac2-3_bf16] step 334/1000 (33.4%)  wall= 500.9s  tps≈  682.9
[orchard][ref_no_flash_mac2-3_bf16] step 341/1000 (34.1%)  wall= 511.5s  tps≈  682.7
[orchard][ref_no_flash_mac2-3_bf16] step 348/1000 (34.8%)  wall= 522.0s  tps≈  682.7
[orchard][ref_no_flash_mac2-3_bf16] step 355/1000 (35.5%)  wall= 533.0s  tps≈  682.1
[orchard][ref_no_flash_mac2-3_bf16] step 362/1000 (36.2%)  wall= 543.5s  tps≈  682.1
[orchard][ref_no_flash_mac2-3_bf16] step 369/1000 (36.9%)  wall= 554.2s  tps≈  681.8
[orchard][ref_no_flash_mac2-3_bf16] step 376/1000 (37.6%)  wall= 564.7s  tps≈  681.8
[orchard][ref_no_flash_mac2-3_bf16] step 383/1000 (38.3%)  wall= 575.2s  tps≈  681.9
[orchard][ref_no_flash_mac2-3_bf16] step 390/1000 (39.0%)  wall= 586.8s  tps≈  680.5
[orchard][ref_no_flash_mac2-3_bf16] step 397/1000 (39.7%)  wall= 597.4s  tps≈  680.5
[orchard][ref_no_flash_mac2-3_bf16] step 404/1000 (40.4%)  wall= 607.9s  tps≈  680.5
[orchard][ref_no_flash_mac2-3_bf16] step 411/1000 (41.1%)  wall= 618.6s  tps≈  680.4
[orchard][ref_no_flash_mac2-3_bf16] step 418/1000 (41.8%)  wall= 628.9s  tps≈  680.6
[orchard][ref_no_flash_mac2-3_bf16] step 424/1000 (42.4%)  wall= 638.9s  tps≈  679.5
[orchard][ref_no_flash_mac2-3_bf16] step 431/1000 (43.1%)  wall= 650.1s  tps≈  678.9
[orchard][ref_no_flash_mac2-3_bf16] step 438/1000 (43.8%)  wall= 660.7s  tps≈  678.9
[orchard][ref_no_flash_mac2-3_bf16] step 445/1000 (44.5%)  wall= 671.5s  tps≈  678.6
[orchard][ref_no_flash_mac2-3_bf16] step 452/1000 (45.2%)  wall= 682.0s  tps≈  678.7
[orchard][ref_no_flash_mac2-3_bf16] step 459/1000 (45.9%)  wall= 692.5s  tps≈  678.7
[orchard][ref_no_flash_mac2-3_bf16] step 466/1000 (46.6%)  wall= 703.1s  tps≈  678.7
[orchard][ref_no_flash_mac2-3_bf16] step 472/1000 (47.2%)  wall= 713.5s  tps≈  677.4
[orchard][ref_no_flash_mac2-3_bf16] step 479/1000 (47.9%)  wall= 725.2s  tps≈  676.4
[orchard][ref_no_flash_mac2-3_bf16] step 486/1000 (48.6%)  wall= 736.0s  tps≈  676.1
[orchard][ref_no_flash_mac2-3_bf16] step 493/1000 (49.3%)  wall= 747.5s  tps≈  675.4
[orchard][ref_no_flash_mac2-3_bf16] step 500/1000 (50.0%)  wall= 758.8s  tps≈  674.8
[orchard][ref_no_flash_mac2-3_bf16] step 507/1000 (50.7%)  wall= 770.3s  tps≈  674.0
[orchard][ref_no_flash_mac2-3_bf16] step 513/1000 (51.3%)  wall= 780.5s  tps≈  673.0
[orchard][ref_no_flash_mac2-3_bf16] step 519/1000 (51.9%)  wall= 790.9s  tps≈  672.0
[orchard][ref_no_flash_mac2-3_bf16] step 526/1000 (52.6%)  wall= 801.7s  tps≈  671.9
[orchard][ref_no_flash_mac2-3_bf16] step 533/1000 (53.3%)  wall= 812.6s  tps≈  671.7
[orchard][ref_no_flash_mac2-3_bf16] step 540/1000 (54.0%)  wall= 823.3s  tps≈  671.6
[orchard][ref_no_flash_mac2-3_bf16] step 547/1000 (54.7%)  wall= 833.8s  tps≈  671.8
[orchard][ref_no_flash_mac2-3_bf16] step 554/1000 (55.4%)  wall= 844.5s  tps≈  671.7
[orchard][ref_no_flash_mac2-3_bf16] step 561/1000 (56.1%)  wall= 855.1s  tps≈  671.8
[orchard][ref_no_flash_mac2-3_bf16] step 568/1000 (56.8%)  wall= 865.5s  tps≈  672.0
[orchard][ref_no_flash_mac2-3_bf16] step 575/1000 (57.5%)  wall= 875.8s  tps≈  672.3
[orchard][ref_no_flash_mac2-3_bf16] step 582/1000 (58.2%)  wall= 886.5s  tps≈  672.3
[orchard][ref_no_flash_mac2-3_bf16] step 589/1000 (58.9%)  wall= 897.1s  tps≈  672.3
[orchard][ref_no_flash_mac2-3_bf16] step 596/1000 (59.6%)  wall= 907.7s  tps≈  672.4
[orchard][ref_no_flash_mac2-3_bf16] step 603/1000 (60.3%)  wall= 918.6s  tps≈  672.2
[orchard][ref_no_flash_mac2-3_bf16] step 610/1000 (61.0%)  wall= 928.7s  tps≈  672.6
[orchard][ref_no_flash_mac2-3_bf16] step 617/1000 (61.7%)  wall= 939.7s  tps≈  672.3
[orchard][ref_no_flash_mac2-3_bf16] step 624/1000 (62.4%)  wall= 950.0s  tps≈  672.6
[orchard][ref_no_flash_mac2-3_bf16] step 631/1000 (63.1%)  wall= 960.7s  tps≈  672.6
[orchard][ref_no_flash_mac2-3_bf16] step 638/1000 (63.8%)  wall= 971.2s  tps≈  672.7
[orchard][ref_no_flash_mac2-3_bf16] step 645/1000 (64.5%)  wall= 982.0s  tps≈  672.6
[orchard][ref_no_flash_mac2-3_bf16] step 652/1000 (65.2%)  wall= 992.7s  tps≈  672.6
[orchard][ref_no_flash_mac2-3_bf16] step 659/1000 (65.9%)  wall=1003.3s  tps≈  672.6
[orchard][ref_no_flash_mac2-3_bf16] step 666/1000 (66.6%)  wall=1014.5s  tps≈  672.2
[orchard][ref_no_flash_mac2-3_bf16] step 673/1000 (67.3%)  wall=1025.3s  tps≈  672.1
[orchard][ref_no_flash_mac2-3_bf16] step 680/1000 (68.0%)  wall=1035.8s  tps≈  672.3
[orchard][ref_no_flash_mac2-3_bf16] step 687/1000 (68.7%)  wall=1046.4s  tps≈  672.3
[orchard][ref_no_flash_mac2-3_bf16] step 694/1000 (69.4%)  wall=1057.5s  tps≈  672.0
[orchard][ref_no_flash_mac2-3_bf16] step 701/1000 (70.1%)  wall=1068.4s  tps≈  671.9
[orchard][ref_no_flash_mac2-3_bf16] step 708/1000 (70.8%)  wall=1079.8s  tps≈  671.4
[orchard][ref_no_flash_mac2-3_bf16] step 714/1000 (71.4%)  wall=1089.8s  tps≈  670.9
[orchard][ref_no_flash_mac2-3_bf16] step 721/1000 (72.1%)  wall=1101.4s  tps≈  670.3
[orchard][ref_no_flash_mac2-3_bf16] step 728/1000 (72.8%)  wall=1112.4s  tps≈  670.1
[orchard][ref_no_flash_mac2-3_bf16] step 734/1000 (73.4%)  wall=1122.9s  tps≈  669.4
[orchard][ref_no_flash_mac2-3_bf16] step 741/1000 (74.1%)  wall=1133.8s  tps≈  669.2
[orchard][ref_no_flash_mac2-3_bf16] step 748/1000 (74.8%)  wall=1145.4s  tps≈  668.7
[orchard][ref_no_flash_mac2-3_bf16] step 755/1000 (75.5%)  wall=1155.8s  tps≈  668.9
[orchard][ref_no_flash_mac2-3_bf16] step 762/1000 (76.2%)  wall=1166.7s  tps≈  668.8
[orchard][ref_no_flash_mac2-3_bf16] step 769/1000 (76.9%)  wall=1177.4s  tps≈  668.8
[orchard][ref_no_flash_mac2-3_bf16] step 776/1000 (77.6%)  wall=1188.1s  tps≈  668.8
[orchard][ref_no_flash_mac2-3_bf16] step 783/1000 (78.3%)  wall=1199.2s  tps≈  668.6
[orchard][ref_no_flash_mac2-3_bf16] step 789/1000 (78.9%)  wall=1209.5s  tps≈  668.0
[orchard][ref_no_flash_mac2-3_bf16] step 795/1000 (79.5%)  wall=1220.1s  tps≈  667.3
[orchard][ref_no_flash_mac2-3_bf16] step 802/1000 (80.2%)  wall=1231.3s  tps≈  667.0
[orchard][ref_no_flash_mac2-3_bf16] step 808/1000 (80.8%)  wall=1241.5s  tps≈  666.5
[orchard][ref_no_flash_mac2-3_bf16] step 815/1000 (81.5%)  wall=1253.0s  tps≈  666.0
[orchard][ref_no_flash_mac2-3_bf16] step 821/1000 (82.1%)  wall=1263.5s  tps≈  665.4
[orchard][ref_no_flash_mac2-3_bf16] step 828/1000 (82.8%)  wall=1274.4s  tps≈  665.3
[orchard][ref_no_flash_mac2-3_bf16] step 835/1000 (83.5%)  wall=1285.8s  tps≈  665.0
[orchard][ref_no_flash_mac2-3_bf16] step 842/1000 (84.2%)  wall=1296.5s  tps≈  665.0
[orchard][ref_no_flash_mac2-3_bf16] step 849/1000 (84.9%)  wall=1307.2s  tps≈  665.1
[orchard][ref_no_flash_mac2-3_bf16] step 856/1000 (85.6%)  wall=1318.2s  tps≈  665.0
[orchard][ref_no_flash_mac2-3_bf16] step 863/1000 (86.3%)  wall=1329.2s  tps≈  664.8
[orchard][ref_no_flash_mac2-3_bf16] step 870/1000 (87.0%)  wall=1339.7s  tps≈  665.0
[orchard][ref_no_flash_mac2-3_bf16] step 874/1000 (87.4%)  wall=1349.7s  tps≈  663.1
[orchard][ref_no_flash_mac2-3_bf16] step 876/1000 (87.6%)  wall=1362.4s  tps≈  658.4
[orchard][ref_no_flash_mac2-3_bf16] step 878/1000 (87.8%)  wall=1382.3s  tps≈  650.4
[orchard][ref_no_flash_mac2-3_bf16] step 880/1000 (88.0%)  wall=1401.3s  tps≈  643.1
[orchard][ref_no_flash_mac2-3_bf16] step 881/1000 (88.1%)  wall=1411.7s  tps≈  639.0
[orchard][ref_no_flash_mac2-3_bf16] step 882/1000 (88.2%)  wall=1422.4s  tps≈  635.0
[orchard][ref_no_flash_mac2-3_bf16] step 885/1000 (88.5%)  wall=1433.6s  tps≈  632.1
[orchard][ref_no_flash_mac2-3_bf16] step 892/1000 (89.2%)  wall=1444.8s  tps≈  632.2
[orchard][ref_no_flash_mac2-3_bf16] step 898/1000 (89.8%)  wall=1455.0s  tps≈  632.0
[orchard][ref_no_flash_mac2-3_bf16] step 904/1000 (90.4%)  wall=1465.6s  tps≈  631.6
[orchard][ref_no_flash_mac2-3_bf16] step 911/1000 (91.1%)  wall=1477.0s  tps≈  631.6
[orchard][ref_no_flash_mac2-3_bf16] step 917/1000 (91.7%)  wall=1487.3s  tps≈  631.3
[orchard][ref_no_flash_mac2-3_bf16] step 924/1000 (92.4%)  wall=1499.1s  tps≈  631.2
[orchard][ref_no_flash_mac2-3_bf16] step 931/1000 (93.1%)  wall=1510.5s  tps≈  631.1
[orchard][ref_no_flash_mac2-3_bf16] step 938/1000 (93.8%)  wall=1521.5s  tps≈  631.3
[orchard][ref_no_flash_mac2-3_bf16] step 945/1000 (94.5%)  wall=1532.7s  tps≈  631.4
[orchard][ref_no_flash_mac2-3_bf16] step 952/1000 (95.2%)  wall=1543.7s  tps≈  631.5
[orchard][ref_no_flash_mac2-3_bf16] step 959/1000 (95.9%)  wall=1554.7s  tps≈  631.6
[orchard][ref_no_flash_mac2-3_bf16] step 966/1000 (96.6%)  wall=1565.5s  tps≈  631.9
[orchard][ref_no_flash_mac2-3_bf16] step 972/1000 (97.2%)  wall=1575.6s  tps≈  631.7
[orchard][ref_no_flash_mac2-3_bf16] step 979/1000 (97.9%)  wall=1586.8s  tps≈  631.8
[orchard][ref_no_flash_mac2-3_bf16] step 986/1000 (98.6%)  wall=1597.9s  tps≈  631.9
[orchard][ref_no_flash_mac2-3_bf16] step 993/1000 (99.3%)  wall=1609.1s  tps≈  631.9
[orchard][ref_no_flash_mac2-3_bf16] step 1000/1000 (100.0%)  wall=1620.2s  tps≈  632.0
JSON:{"schema": "orchard_bench_v1", "tag": "ref_no_flash_mac2-3_bf16", "commit": "34969e4", "dataset_sha": "57f3eb280cfe78d8cebe3aa76d7416607845416e22464dd9709ccb487f8d7b92", "batch": 2, "seq": 512, "micro_steps": 1000, "total_tokens": 1024000, "throughput_tps": 631.9361066068927, "tokenize_s": 9.9155, "copy_s": 17.8818, "copy_mb_s": 0.46, "train_s": 0.0, "host_to_gpu_mb": 8.19, "avg_loss_stub": 0.574789007376181, "max_grad": 159.0, "dtype": "torch.bfloat16", "bf16": true, "flash": {"enabled": false}, "metal_ver": "unknown", "seed": 42, "timeline": [], "avg_gpu_w": 5352.846177944863, "avg_gpu_temp": null}
