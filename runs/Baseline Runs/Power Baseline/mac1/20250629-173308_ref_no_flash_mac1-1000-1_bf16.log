/Users/ianreitsma/projects/orchard/orchard-env/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
`loss_type=None` was set in the config but it is unrecognised.Using the default loss: `ForCausalLMLoss`.
[orchard][ref_no_flash_mac1-1_bf16] step 1/1000 ( 0.1%)  wall=   1.9s  tps≈  534.7
[orchard][ref_no_flash_mac1-1_bf16] step 8/1000 ( 0.8%)  wall=  13.0s  tps≈  628.0
[orchard][ref_no_flash_mac1-1_bf16] step 15/1000 ( 1.5%)  wall=  23.6s  tps≈  652.2
[orchard][ref_no_flash_mac1-1_bf16] step 22/1000 ( 2.2%)  wall=  34.5s  tps≈  653.1
[orchard][ref_no_flash_mac1-1_bf16] step 29/1000 ( 2.9%)  wall=  45.1s  tps≈  658.6
[orchard][ref_no_flash_mac1-1_bf16] step 36/1000 ( 3.6%)  wall=  56.1s  tps≈  657.6
[orchard][ref_no_flash_mac1-1_bf16] step 43/1000 ( 4.3%)  wall=  66.9s  tps≈  658.5
[orchard][ref_no_flash_mac1-1_bf16] step 50/1000 ( 5.0%)  wall=  77.3s  tps≈  662.0
[orchard][ref_no_flash_mac1-1_bf16] step 57/1000 ( 5.7%)  wall=  88.0s  tps≈  663.0
[orchard][ref_no_flash_mac1-1_bf16] step 63/1000 ( 6.3%)  wall=  98.2s  tps≈  657.1
[orchard][ref_no_flash_mac1-1_bf16] step 70/1000 ( 7.0%)  wall= 109.1s  tps≈  657.3
[orchard][ref_no_flash_mac1-1_bf16] step 77/1000 ( 7.7%)  wall= 119.7s  tps≈  658.5
[orchard][ref_no_flash_mac1-1_bf16] step 84/1000 ( 8.4%)  wall= 130.8s  tps≈  657.6
[orchard][ref_no_flash_mac1-1_bf16] step 91/1000 ( 9.1%)  wall= 141.2s  tps≈  660.1
[orchard][ref_no_flash_mac1-1_bf16] step 97/1000 ( 9.7%)  wall= 151.2s  tps≈  657.0
[orchard][ref_no_flash_mac1-1_bf16] step 104/1000 (10.4%)  wall= 162.2s  tps≈  656.7
[orchard][ref_no_flash_mac1-1_bf16] step 111/1000 (11.1%)  wall= 172.9s  tps≈  657.4
[orchard][ref_no_flash_mac1-1_bf16] step 118/1000 (11.8%)  wall= 183.7s  tps≈  657.6
[orchard][ref_no_flash_mac1-1_bf16] step 125/1000 (12.5%)  wall= 194.1s  tps≈  659.3
[orchard][ref_no_flash_mac1-1_bf16] step 132/1000 (13.2%)  wall= 204.6s  tps≈  660.7
[orchard][ref_no_flash_mac1-1_bf16] step 138/1000 (13.8%)  wall= 214.8s  tps≈  658.0
[orchard][ref_no_flash_mac1-1_bf16] step 145/1000 (14.5%)  wall= 226.5s  tps≈  655.5
[orchard][ref_no_flash_mac1-1_bf16] step 152/1000 (15.2%)  wall= 237.5s  tps≈  655.4
[orchard][ref_no_flash_mac1-1_bf16] step 159/1000 (15.9%)  wall= 248.2s  tps≈  655.9
[orchard][ref_no_flash_mac1-1_bf16] step 166/1000 (16.6%)  wall= 258.9s  tps≈  656.6
[orchard][ref_no_flash_mac1-1_bf16] step 173/1000 (17.3%)  wall= 269.2s  tps≈  658.0
[orchard][ref_no_flash_mac1-1_bf16] step 180/1000 (18.0%)  wall= 280.3s  tps≈  657.5
[orchard][ref_no_flash_mac1-1_bf16] step 187/1000 (18.7%)  wall= 291.1s  tps≈  657.8
[orchard][ref_no_flash_mac1-1_bf16] step 194/1000 (19.4%)  wall= 301.9s  tps≈  658.0
[orchard][ref_no_flash_mac1-1_bf16] step 201/1000 (20.1%)  wall= 313.4s  tps≈  656.8
[orchard][ref_no_flash_mac1-1_bf16] step 207/1000 (20.7%)  wall= 323.7s  tps≈  654.8
[orchard][ref_no_flash_mac1-1_bf16] step 214/1000 (21.4%)  wall= 335.3s  tps≈  653.6
[orchard][ref_no_flash_mac1-1_bf16] step 220/1000 (22.0%)  wall= 345.6s  tps≈  651.9
[orchard][ref_no_flash_mac1-1_bf16] step 226/1000 (22.6%)  wall= 355.7s  tps≈  650.5
[orchard][ref_no_flash_mac1-1_bf16] step 233/1000 (23.3%)  wall= 366.8s  tps≈  650.4
[orchard][ref_no_flash_mac1-1_bf16] step 240/1000 (24.0%)  wall= 377.7s  tps≈  650.7
[orchard][ref_no_flash_mac1-1_bf16] step 247/1000 (24.7%)  wall= 388.3s  tps≈  651.4
[orchard][ref_no_flash_mac1-1_bf16] step 252/1000 (25.2%)  wall= 398.5s  tps≈  647.6
[orchard][ref_no_flash_mac1-1_bf16] step 259/1000 (25.9%)  wall= 409.7s  tps≈  647.4
[orchard][ref_no_flash_mac1-1_bf16] step 266/1000 (26.6%)  wall= 420.3s  tps≈  648.1
[orchard][ref_no_flash_mac1-1_bf16] step 273/1000 (27.3%)  wall= 431.2s  tps≈  648.4
[orchard][ref_no_flash_mac1-1_bf16] step 280/1000 (28.0%)  wall= 442.1s  tps≈  648.6
[orchard][ref_no_flash_mac1-1_bf16] step 287/1000 (28.7%)  wall= 453.3s  tps≈  648.3
[orchard][ref_no_flash_mac1-1_bf16] step 294/1000 (29.4%)  wall= 464.6s  tps≈  648.1
[orchard][ref_no_flash_mac1-1_bf16] step 301/1000 (30.1%)  wall= 475.6s  tps≈  648.1
[orchard][ref_no_flash_mac1-1_bf16] step 308/1000 (30.8%)  wall= 486.4s  tps≈  648.4
[orchard][ref_no_flash_mac1-1_bf16] step 315/1000 (31.5%)  wall= 497.3s  tps≈  648.6
[orchard][ref_no_flash_mac1-1_bf16] step 322/1000 (32.2%)  wall= 508.8s  tps≈  648.0
[orchard][ref_no_flash_mac1-1_bf16] step 327/1000 (32.7%)  wall= 519.6s  tps≈  644.4
[orchard][ref_no_flash_mac1-1_bf16] step 333/1000 (33.3%)  wall= 531.3s  tps≈  641.8
[orchard][ref_no_flash_mac1-1_bf16] step 339/1000 (33.9%)  wall= 541.6s  tps≈  640.9
[orchard][ref_no_flash_mac1-1_bf16] step 346/1000 (34.6%)  wall= 552.5s  tps≈  641.3
[orchard][ref_no_flash_mac1-1_bf16] step 353/1000 (35.3%)  wall= 563.2s  tps≈  641.9
[orchard][ref_no_flash_mac1-1_bf16] step 360/1000 (36.0%)  wall= 574.1s  tps≈  642.1
[orchard][ref_no_flash_mac1-1_bf16] step 367/1000 (36.7%)  wall= 585.0s  tps≈  642.4
[orchard][ref_no_flash_mac1-1_bf16] step 374/1000 (37.4%)  wall= 595.6s  tps≈  643.0
[orchard][ref_no_flash_mac1-1_bf16] step 381/1000 (38.1%)  wall= 605.9s  tps≈  643.9
[orchard][ref_no_flash_mac1-1_bf16] step 388/1000 (38.8%)  wall= 616.7s  tps≈  644.3
[orchard][ref_no_flash_mac1-1_bf16] step 395/1000 (39.5%)  wall= 626.9s  tps≈  645.2
[orchard][ref_no_flash_mac1-1_bf16] step 402/1000 (40.2%)  wall= 637.2s  tps≈  646.0
[orchard][ref_no_flash_mac1-1_bf16] step 409/1000 (40.9%)  wall= 647.4s  tps≈  646.9
[orchard][ref_no_flash_mac1-1_bf16] step 416/1000 (41.6%)  wall= 657.6s  tps≈  647.8
[orchard][ref_no_flash_mac1-1_bf16] step 423/1000 (42.3%)  wall= 667.8s  tps≈  648.6
[orchard][ref_no_flash_mac1-1_bf16] step 430/1000 (43.0%)  wall= 678.4s  tps≈  649.1
[orchard][ref_no_flash_mac1-1_bf16] step 437/1000 (43.7%)  wall= 688.6s  tps≈  649.9
[orchard][ref_no_flash_mac1-1_bf16] step 444/1000 (44.4%)  wall= 699.1s  tps≈  650.3
[orchard][ref_no_flash_mac1-1_bf16] step 451/1000 (45.1%)  wall= 709.5s  tps≈  650.9
[orchard][ref_no_flash_mac1-1_bf16] step 458/1000 (45.8%)  wall= 719.8s  tps≈  651.6
[orchard][ref_no_flash_mac1-1_bf16] step 465/1000 (46.5%)  wall= 730.1s  tps≈  652.2
[orchard][ref_no_flash_mac1-1_bf16] step 472/1000 (47.2%)  wall= 740.8s  tps≈  652.5
[orchard][ref_no_flash_mac1-1_bf16] step 479/1000 (47.9%)  wall= 751.3s  tps≈  652.9
[orchard][ref_no_flash_mac1-1_bf16] step 486/1000 (48.6%)  wall= 761.5s  tps≈  653.5
[orchard][ref_no_flash_mac1-1_bf16] step 493/1000 (49.3%)  wall= 771.7s  tps≈  654.2
[orchard][ref_no_flash_mac1-1_bf16] step 500/1000 (50.0%)  wall= 781.9s  tps≈  654.8
[orchard][ref_no_flash_mac1-1_bf16] step 507/1000 (50.7%)  wall= 792.2s  tps≈  655.3
[orchard][ref_no_flash_mac1-1_bf16] step 514/1000 (51.4%)  wall= 802.6s  tps≈  655.8
[orchard][ref_no_flash_mac1-1_bf16] step 521/1000 (52.1%)  wall= 812.8s  tps≈  656.3
[orchard][ref_no_flash_mac1-1_bf16] step 528/1000 (52.8%)  wall= 823.8s  tps≈  656.3
[orchard][ref_no_flash_mac1-1_bf16] step 535/1000 (53.5%)  wall= 835.6s  tps≈  655.6
[orchard][ref_no_flash_mac1-1_bf16] step 542/1000 (54.2%)  wall= 846.7s  tps≈  655.5
[orchard][ref_no_flash_mac1-1_bf16] step 549/1000 (54.9%)  wall= 857.2s  tps≈  655.8
[orchard][ref_no_flash_mac1-1_bf16] step 556/1000 (55.6%)  wall= 868.0s  tps≈  656.0
[orchard][ref_no_flash_mac1-1_bf16] step 563/1000 (56.3%)  wall= 878.4s  tps≈  656.3
[orchard][ref_no_flash_mac1-1_bf16] step 570/1000 (57.0%)  wall= 889.3s  tps≈  656.3
[orchard][ref_no_flash_mac1-1_bf16] step 577/1000 (57.7%)  wall= 899.6s  tps≈  656.8
[orchard][ref_no_flash_mac1-1_bf16] step 584/1000 (58.4%)  wall= 909.7s  tps≈  657.4
[orchard][ref_no_flash_mac1-1_bf16] step 591/1000 (59.1%)  wall= 919.9s  tps≈  657.9
[orchard][ref_no_flash_mac1-1_bf16] step 598/1000 (59.8%)  wall= 930.0s  tps≈  658.4
[orchard][ref_no_flash_mac1-1_bf16] step 605/1000 (60.5%)  wall= 940.3s  tps≈  658.9
[orchard][ref_no_flash_mac1-1_bf16] step 612/1000 (61.2%)  wall= 950.6s  tps≈  659.3
[orchard][ref_no_flash_mac1-1_bf16] step 619/1000 (61.9%)  wall= 960.9s  tps≈  659.6
[orchard][ref_no_flash_mac1-1_bf16] step 626/1000 (62.6%)  wall= 971.3s  tps≈  659.9
[orchard][ref_no_flash_mac1-1_bf16] step 633/1000 (63.3%)  wall= 981.6s  tps≈  660.3
[orchard][ref_no_flash_mac1-1_bf16] step 640/1000 (64.0%)  wall= 992.0s  tps≈  660.7
[orchard][ref_no_flash_mac1-1_bf16] step 647/1000 (64.7%)  wall=1002.3s  tps≈  661.0
[orchard][ref_no_flash_mac1-1_bf16] step 654/1000 (65.4%)  wall=1012.6s  tps≈  661.3
[orchard][ref_no_flash_mac1-1_bf16] step 661/1000 (66.1%)  wall=1022.9s  tps≈  661.7
[orchard][ref_no_flash_mac1-1_bf16] step 668/1000 (66.8%)  wall=1033.3s  tps≈  662.0
[orchard][ref_no_flash_mac1-1_bf16] step 675/1000 (67.5%)  wall=1043.5s  tps≈  662.4
[orchard][ref_no_flash_mac1-1_bf16] step 682/1000 (68.2%)  wall=1054.8s  tps≈  662.1
[orchard][ref_no_flash_mac1-1_bf16] step 689/1000 (68.9%)  wall=1065.3s  tps≈  662.3
[orchard][ref_no_flash_mac1-1_bf16] step 696/1000 (69.6%)  wall=1075.7s  tps≈  662.5
[orchard][ref_no_flash_mac1-1_bf16] step 703/1000 (70.3%)  wall=1085.9s  tps≈  662.9
[orchard][ref_no_flash_mac1-1_bf16] step 710/1000 (71.0%)  wall=1096.1s  tps≈  663.3
[orchard][ref_no_flash_mac1-1_bf16] step 717/1000 (71.7%)  wall=1106.2s  tps≈  663.7
[orchard][ref_no_flash_mac1-1_bf16] step 724/1000 (72.4%)  wall=1116.7s  tps≈  663.9
[orchard][ref_no_flash_mac1-1_bf16] step 731/1000 (73.1%)  wall=1127.8s  tps≈  663.7
[orchard][ref_no_flash_mac1-1_bf16] step 738/1000 (73.8%)  wall=1138.9s  tps≈  663.5
[orchard][ref_no_flash_mac1-1_bf16] step 745/1000 (74.5%)  wall=1149.2s  tps≈  663.8
[orchard][ref_no_flash_mac1-1_bf16] step 752/1000 (75.2%)  wall=1159.5s  tps≈  664.1
[orchard][ref_no_flash_mac1-1_bf16] step 759/1000 (75.9%)  wall=1169.7s  tps≈  664.5
[orchard][ref_no_flash_mac1-1_bf16] step 766/1000 (76.6%)  wall=1180.3s  tps≈  664.5
[orchard][ref_no_flash_mac1-1_bf16] step 773/1000 (77.3%)  wall=1190.9s  tps≈  664.7
[orchard][ref_no_flash_mac1-1_bf16] step 780/1000 (78.0%)  wall=1201.4s  tps≈  664.8
[orchard][ref_no_flash_mac1-1_bf16] step 787/1000 (78.7%)  wall=1211.7s  tps≈  665.1
[orchard][ref_no_flash_mac1-1_bf16] step 794/1000 (79.4%)  wall=1222.0s  tps≈  665.4
[orchard][ref_no_flash_mac1-1_bf16] step 801/1000 (80.1%)  wall=1232.3s  tps≈  665.6
[orchard][ref_no_flash_mac1-1_bf16] step 808/1000 (80.8%)  wall=1242.5s  tps≈  665.9
[orchard][ref_no_flash_mac1-1_bf16] step 815/1000 (81.5%)  wall=1252.9s  tps≈  666.1
[orchard][ref_no_flash_mac1-1_bf16] step 822/1000 (82.2%)  wall=1263.0s  tps≈  666.4
[orchard][ref_no_flash_mac1-1_bf16] step 829/1000 (82.9%)  wall=1273.3s  tps≈  666.7
[orchard][ref_no_flash_mac1-1_bf16] step 836/1000 (83.6%)  wall=1283.4s  tps≈  667.0
[orchard][ref_no_flash_mac1-1_bf16] step 843/1000 (84.3%)  wall=1293.8s  tps≈  667.2
[orchard][ref_no_flash_mac1-1_bf16] step 850/1000 (85.0%)  wall=1304.0s  tps≈  667.5
[orchard][ref_no_flash_mac1-1_bf16] step 856/1000 (85.6%)  wall=1315.2s  tps≈  666.4
[orchard][ref_no_flash_mac1-1_bf16] step 863/1000 (86.3%)  wall=1325.6s  tps≈  666.7
[orchard][ref_no_flash_mac1-1_bf16] step 870/1000 (87.0%)  wall=1336.9s  tps≈  666.4
[orchard][ref_no_flash_mac1-1_bf16] step 876/1000 (87.6%)  wall=1347.2s  tps≈  665.9
[orchard][ref_no_flash_mac1-1_bf16] step 883/1000 (88.3%)  wall=1357.8s  tps≈  665.9
[orchard][ref_no_flash_mac1-1_bf16] step 890/1000 (89.0%)  wall=1368.2s  tps≈  666.1
[orchard][ref_no_flash_mac1-1_bf16] step 897/1000 (89.7%)  wall=1379.1s  tps≈  666.0
[orchard][ref_no_flash_mac1-1_bf16] step 904/1000 (90.4%)  wall=1389.4s  tps≈  666.2
[orchard][ref_no_flash_mac1-1_bf16] step 911/1000 (91.1%)  wall=1399.6s  tps≈  666.5
[orchard][ref_no_flash_mac1-1_bf16] step 918/1000 (91.8%)  wall=1409.8s  tps≈  666.8
[orchard][ref_no_flash_mac1-1_bf16] step 925/1000 (92.5%)  wall=1420.0s  tps≈  667.0
[orchard][ref_no_flash_mac1-1_bf16] step 932/1000 (93.2%)  wall=1430.4s  tps≈  667.2
[orchard][ref_no_flash_mac1-1_bf16] step 939/1000 (93.9%)  wall=1440.9s  tps≈  667.3
[orchard][ref_no_flash_mac1-1_bf16] step 946/1000 (94.6%)  wall=1451.1s  tps≈  667.6
[orchard][ref_no_flash_mac1-1_bf16] step 953/1000 (95.3%)  wall=1461.3s  tps≈  667.8
[orchard][ref_no_flash_mac1-1_bf16] step 960/1000 (96.0%)  wall=1471.9s  tps≈  667.9
[orchard][ref_no_flash_mac1-1_bf16] step 967/1000 (96.7%)  wall=1482.2s  tps≈  668.1
[orchard][ref_no_flash_mac1-1_bf16] step 974/1000 (97.4%)  wall=1492.5s  tps≈  668.2
[orchard][ref_no_flash_mac1-1_bf16] step 981/1000 (98.1%)  wall=1503.6s  tps≈  668.1
[orchard][ref_no_flash_mac1-1_bf16] step 988/1000 (98.8%)  wall=1514.3s  tps≈  668.1
[orchard][ref_no_flash_mac1-1_bf16] step 995/1000 (99.5%)  wall=1524.5s  tps≈  668.4
[orchard][ref_no_flash_mac1-1_bf16] step 1000/1000 (100.0%)  wall=1531.6s  tps≈  668.6
JSON:{"schema": "orchard_bench_v1", "tag": "ref_no_flash_mac1-1_bf16", "commit": "34969e4", "dataset_sha": "57f3eb280cfe78d8cebe3aa76d7416607845416e22464dd9709ccb487f8d7b92", "batch": 2, "seq": 512, "micro_steps": 1000, "total_tokens": 1024000, "throughput_tps": 668.4485978759948, "tokenize_s": 9.095, "copy_s": 21.4742, "copy_mb_s": 0.38, "train_s": 0.0, "host_to_gpu_mb": 8.19, "avg_loss_stub": 0.5746824797387234, "max_grad": 159.0, "dtype": "torch.bfloat16", "bf16": true, "flash": {"enabled": false}, "metal_ver": "32023.620", "seed": 42, "timeline": [], "avg_gpu_w": 5577.038486842105, "avg_gpu_temp": null}
