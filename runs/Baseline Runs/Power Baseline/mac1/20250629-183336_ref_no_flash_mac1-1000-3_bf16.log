/Users/ianreitsma/projects/orchard/orchard-env/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
`loss_type=None` was set in the config but it is unrecognised.Using the default loss: `ForCausalLMLoss`.
[orchard][ref_no_flash_mac1-3_bf16] step 1/1000 ( 0.1%)  wall=   1.9s  tps≈  538.3
[orchard][ref_no_flash_mac1-3_bf16] step 8/1000 ( 0.8%)  wall=  12.8s  tps≈  638.9
[orchard][ref_no_flash_mac1-3_bf16] step 15/1000 ( 1.5%)  wall=  23.3s  tps≈  658.9
[orchard][ref_no_flash_mac1-3_bf16] step 22/1000 ( 2.2%)  wall=  33.8s  tps≈  665.6
[orchard][ref_no_flash_mac1-3_bf16] step 29/1000 ( 2.9%)  wall=  44.5s  tps≈  667.5
[orchard][ref_no_flash_mac1-3_bf16] step 36/1000 ( 3.6%)  wall=  54.7s  tps≈  673.9
[orchard][ref_no_flash_mac1-3_bf16] step 43/1000 ( 4.3%)  wall=  65.0s  tps≈  677.6
[orchard][ref_no_flash_mac1-3_bf16] step 50/1000 ( 5.0%)  wall=  75.3s  tps≈  679.6
[orchard][ref_no_flash_mac1-3_bf16] step 57/1000 ( 5.7%)  wall=  85.6s  tps≈  682.2
[orchard][ref_no_flash_mac1-3_bf16] step 64/1000 ( 6.4%)  wall=  95.8s  tps≈  683.8
[orchard][ref_no_flash_mac1-3_bf16] step 71/1000 ( 7.1%)  wall= 106.0s  tps≈  685.7
[orchard][ref_no_flash_mac1-3_bf16] step 78/1000 ( 7.8%)  wall= 116.3s  tps≈  687.1
[orchard][ref_no_flash_mac1-3_bf16] step 85/1000 ( 8.5%)  wall= 126.4s  tps≈  688.4
[orchard][ref_no_flash_mac1-3_bf16] step 92/1000 ( 9.2%)  wall= 136.6s  tps≈  689.4
[orchard][ref_no_flash_mac1-3_bf16] step 99/1000 ( 9.9%)  wall= 146.8s  tps≈  690.4
[orchard][ref_no_flash_mac1-3_bf16] step 106/1000 (10.6%)  wall= 157.4s  tps≈  689.5
[orchard][ref_no_flash_mac1-3_bf16] step 113/1000 (11.3%)  wall= 167.8s  tps≈  689.8
[orchard][ref_no_flash_mac1-3_bf16] step 120/1000 (12.0%)  wall= 178.2s  tps≈  689.4
[orchard][ref_no_flash_mac1-3_bf16] step 127/1000 (12.7%)  wall= 188.4s  tps≈  690.2
[orchard][ref_no_flash_mac1-3_bf16] step 134/1000 (13.4%)  wall= 198.7s  tps≈  690.6
[orchard][ref_no_flash_mac1-3_bf16] step 141/1000 (14.1%)  wall= 208.9s  tps≈  691.2
[orchard][ref_no_flash_mac1-3_bf16] step 148/1000 (14.8%)  wall= 219.1s  tps≈  691.7
[orchard][ref_no_flash_mac1-3_bf16] step 155/1000 (15.5%)  wall= 229.3s  tps≈  692.1
[orchard][ref_no_flash_mac1-3_bf16] step 162/1000 (16.2%)  wall= 239.6s  tps≈  692.4
[orchard][ref_no_flash_mac1-3_bf16] step 169/1000 (16.9%)  wall= 249.8s  tps≈  692.7
[orchard][ref_no_flash_mac1-3_bf16] step 176/1000 (17.6%)  wall= 260.3s  tps≈  692.3
[orchard][ref_no_flash_mac1-3_bf16] step 183/1000 (18.3%)  wall= 270.9s  tps≈  691.7
[orchard][ref_no_flash_mac1-3_bf16] step 190/1000 (19.0%)  wall= 282.1s  tps≈  689.6
[orchard][ref_no_flash_mac1-3_bf16] step 196/1000 (19.6%)  wall= 292.3s  tps≈  686.6
[orchard][ref_no_flash_mac1-3_bf16] step 202/1000 (20.2%)  wall= 302.7s  tps≈  683.4
[orchard][ref_no_flash_mac1-3_bf16] step 208/1000 (20.8%)  wall= 313.2s  tps≈  679.9
[orchard][ref_no_flash_mac1-3_bf16] step 214/1000 (21.4%)  wall= 323.4s  tps≈  677.5
[orchard][ref_no_flash_mac1-3_bf16] step 221/1000 (22.1%)  wall= 334.9s  tps≈  675.8
[orchard][ref_no_flash_mac1-3_bf16] step 228/1000 (22.8%)  wall= 346.2s  tps≈  674.4
[orchard][ref_no_flash_mac1-3_bf16] step 235/1000 (23.5%)  wall= 357.6s  tps≈  673.0
[orchard][ref_no_flash_mac1-3_bf16] step 242/1000 (24.2%)  wall= 368.6s  tps≈  672.3
[orchard][ref_no_flash_mac1-3_bf16] step 249/1000 (24.9%)  wall= 379.7s  tps≈  671.5
[orchard][ref_no_flash_mac1-3_bf16] step 256/1000 (25.6%)  wall= 390.5s  tps≈  671.3
[orchard][ref_no_flash_mac1-3_bf16] step 263/1000 (26.3%)  wall= 401.7s  tps≈  670.5
[orchard][ref_no_flash_mac1-3_bf16] step 270/1000 (27.0%)  wall= 412.6s  tps≈  670.1
[orchard][ref_no_flash_mac1-3_bf16] step 277/1000 (27.7%)  wall= 423.5s  tps≈  669.8
[orchard][ref_no_flash_mac1-3_bf16] step 284/1000 (28.4%)  wall= 434.1s  tps≈  670.0
[orchard][ref_no_flash_mac1-3_bf16] step 291/1000 (29.1%)  wall= 444.8s  tps≈  670.0
[orchard][ref_no_flash_mac1-3_bf16] step 298/1000 (29.8%)  wall= 455.3s  tps≈  670.2
[orchard][ref_no_flash_mac1-3_bf16] step 305/1000 (30.5%)  wall= 465.8s  tps≈  670.5
[orchard][ref_no_flash_mac1-3_bf16] step 312/1000 (31.2%)  wall= 476.1s  tps≈  671.0
[orchard][ref_no_flash_mac1-3_bf16] step 319/1000 (31.9%)  wall= 486.3s  tps≈  671.7
[orchard][ref_no_flash_mac1-3_bf16] step 326/1000 (32.6%)  wall= 496.5s  tps≈  672.3
[orchard][ref_no_flash_mac1-3_bf16] step 333/1000 (33.3%)  wall= 506.9s  tps≈  672.7
[orchard][ref_no_flash_mac1-3_bf16] step 340/1000 (34.0%)  wall= 517.2s  tps≈  673.2
[orchard][ref_no_flash_mac1-3_bf16] step 347/1000 (34.7%)  wall= 527.4s  tps≈  673.7
[orchard][ref_no_flash_mac1-3_bf16] step 354/1000 (35.4%)  wall= 537.8s  tps≈  674.1
[orchard][ref_no_flash_mac1-3_bf16] step 361/1000 (36.1%)  wall= 548.5s  tps≈  673.9
[orchard][ref_no_flash_mac1-3_bf16] step 368/1000 (36.8%)  wall= 559.4s  tps≈  673.6
[orchard][ref_no_flash_mac1-3_bf16] step 375/1000 (37.5%)  wall= 569.6s  tps≈  674.2
[orchard][ref_no_flash_mac1-3_bf16] step 382/1000 (38.2%)  wall= 580.0s  tps≈  674.4
[orchard][ref_no_flash_mac1-3_bf16] step 389/1000 (38.9%)  wall= 590.4s  tps≈  674.7
[orchard][ref_no_flash_mac1-3_bf16] step 396/1000 (39.6%)  wall= 600.6s  tps≈  675.1
[orchard][ref_no_flash_mac1-3_bf16] step 403/1000 (40.3%)  wall= 611.5s  tps≈  674.8
[orchard][ref_no_flash_mac1-3_bf16] step 409/1000 (40.9%)  wall= 621.7s  tps≈  673.7
[orchard][ref_no_flash_mac1-3_bf16] step 416/1000 (41.6%)  wall= 632.4s  tps≈  673.6
[orchard][ref_no_flash_mac1-3_bf16] step 423/1000 (42.3%)  wall= 643.4s  tps≈  673.2
[orchard][ref_no_flash_mac1-3_bf16] step 429/1000 (42.9%)  wall= 653.5s  tps≈  672.2
[orchard][ref_no_flash_mac1-3_bf16] step 436/1000 (43.6%)  wall= 665.1s  tps≈  671.3
[orchard][ref_no_flash_mac1-3_bf16] step 443/1000 (44.3%)  wall= 676.4s  tps≈  670.6
[orchard][ref_no_flash_mac1-3_bf16] step 450/1000 (45.0%)  wall= 688.0s  tps≈  669.8
[orchard][ref_no_flash_mac1-3_bf16] step 457/1000 (45.7%)  wall= 698.8s  tps≈  669.7
[orchard][ref_no_flash_mac1-3_bf16] step 464/1000 (46.4%)  wall= 709.2s  tps≈  669.9
[orchard][ref_no_flash_mac1-3_bf16] step 471/1000 (47.1%)  wall= 720.3s  tps≈  669.6
[orchard][ref_no_flash_mac1-3_bf16] step 478/1000 (47.8%)  wall= 730.8s  tps≈  669.8
[orchard][ref_no_flash_mac1-3_bf16] step 485/1000 (48.5%)  wall= 741.0s  tps≈  670.2
[orchard][ref_no_flash_mac1-3_bf16] step 492/1000 (49.2%)  wall= 751.2s  tps≈  670.6
[orchard][ref_no_flash_mac1-3_bf16] step 499/1000 (49.9%)  wall= 761.4s  tps≈  671.1
[orchard][ref_no_flash_mac1-3_bf16] step 506/1000 (50.6%)  wall= 772.0s  tps≈  671.2
[orchard][ref_no_flash_mac1-3_bf16] step 513/1000 (51.3%)  wall= 782.7s  tps≈  671.2
[orchard][ref_no_flash_mac1-3_bf16] step 520/1000 (52.0%)  wall= 793.0s  tps≈  671.5
[orchard][ref_no_flash_mac1-3_bf16] step 527/1000 (52.7%)  wall= 803.2s  tps≈  671.9
[orchard][ref_no_flash_mac1-3_bf16] step 534/1000 (53.4%)  wall= 813.4s  tps≈  672.2
[orchard][ref_no_flash_mac1-3_bf16] step 541/1000 (54.1%)  wall= 823.6s  tps≈  672.6
[orchard][ref_no_flash_mac1-3_bf16] step 548/1000 (54.8%)  wall= 833.8s  tps≈  673.0
[orchard][ref_no_flash_mac1-3_bf16] step 555/1000 (55.5%)  wall= 844.1s  tps≈  673.3
[orchard][ref_no_flash_mac1-3_bf16] step 562/1000 (56.2%)  wall= 854.3s  tps≈  673.6
[orchard][ref_no_flash_mac1-3_bf16] step 569/1000 (56.9%)  wall= 864.5s  tps≈  674.0
[orchard][ref_no_flash_mac1-3_bf16] step 576/1000 (57.6%)  wall= 874.8s  tps≈  674.3
[orchard][ref_no_flash_mac1-3_bf16] step 583/1000 (58.3%)  wall= 885.0s  tps≈  674.5
[orchard][ref_no_flash_mac1-3_bf16] step 590/1000 (59.0%)  wall= 895.5s  tps≈  674.7
[orchard][ref_no_flash_mac1-3_bf16] step 597/1000 (59.7%)  wall= 905.8s  tps≈  674.9
[orchard][ref_no_flash_mac1-3_bf16] step 604/1000 (60.4%)  wall= 916.1s  tps≈  675.1
[orchard][ref_no_flash_mac1-3_bf16] step 611/1000 (61.1%)  wall= 926.3s  tps≈  675.4
[orchard][ref_no_flash_mac1-3_bf16] step 618/1000 (61.8%)  wall= 936.6s  tps≈  675.7
[orchard][ref_no_flash_mac1-3_bf16] step 625/1000 (62.5%)  wall= 947.1s  tps≈  675.7
[orchard][ref_no_flash_mac1-3_bf16] step 632/1000 (63.2%)  wall= 957.5s  tps≈  675.9
[orchard][ref_no_flash_mac1-3_bf16] step 639/1000 (63.9%)  wall= 967.9s  tps≈  676.1
[orchard][ref_no_flash_mac1-3_bf16] step 646/1000 (64.6%)  wall= 978.0s  tps≈  676.4
[orchard][ref_no_flash_mac1-3_bf16] step 653/1000 (65.3%)  wall= 988.3s  tps≈  676.6
[orchard][ref_no_flash_mac1-3_bf16] step 660/1000 (66.0%)  wall= 998.9s  tps≈  676.6
[orchard][ref_no_flash_mac1-3_bf16] step 667/1000 (66.7%)  wall=1009.4s  tps≈  676.6
[orchard][ref_no_flash_mac1-3_bf16] step 674/1000 (67.4%)  wall=1019.8s  tps≈  676.8
[orchard][ref_no_flash_mac1-3_bf16] step 681/1000 (68.1%)  wall=1030.3s  tps≈  676.8
[orchard][ref_no_flash_mac1-3_bf16] step 688/1000 (68.8%)  wall=1040.6s  tps≈  677.0
[orchard][ref_no_flash_mac1-3_bf16] step 695/1000 (69.5%)  wall=1050.9s  tps≈  677.2
[orchard][ref_no_flash_mac1-3_bf16] step 702/1000 (70.2%)  wall=1061.1s  tps≈  677.5
[orchard][ref_no_flash_mac1-3_bf16] step 709/1000 (70.9%)  wall=1071.3s  tps≈  677.7
[orchard][ref_no_flash_mac1-3_bf16] step 716/1000 (71.6%)  wall=1081.6s  tps≈  677.9
[orchard][ref_no_flash_mac1-3_bf16] step 723/1000 (72.3%)  wall=1091.8s  tps≈  678.1
[orchard][ref_no_flash_mac1-3_bf16] step 730/1000 (73.0%)  wall=1102.3s  tps≈  678.2
[orchard][ref_no_flash_mac1-3_bf16] step 737/1000 (73.7%)  wall=1112.4s  tps≈  678.4
[orchard][ref_no_flash_mac1-3_bf16] step 744/1000 (74.4%)  wall=1122.6s  tps≈  678.6
[orchard][ref_no_flash_mac1-3_bf16] step 751/1000 (75.1%)  wall=1132.8s  tps≈  678.9
[orchard][ref_no_flash_mac1-3_bf16] step 758/1000 (75.8%)  wall=1143.0s  tps≈  679.1
[orchard][ref_no_flash_mac1-3_bf16] step 765/1000 (76.5%)  wall=1153.4s  tps≈  679.2
[orchard][ref_no_flash_mac1-3_bf16] step 772/1000 (77.2%)  wall=1163.7s  tps≈  679.3
[orchard][ref_no_flash_mac1-3_bf16] step 779/1000 (77.9%)  wall=1173.9s  tps≈  679.5
[orchard][ref_no_flash_mac1-3_bf16] step 786/1000 (78.6%)  wall=1184.1s  tps≈  679.7
[orchard][ref_no_flash_mac1-3_bf16] step 793/1000 (79.3%)  wall=1194.4s  tps≈  679.9
[orchard][ref_no_flash_mac1-3_bf16] step 800/1000 (80.0%)  wall=1204.6s  tps≈  680.1
[orchard][ref_no_flash_mac1-3_bf16] step 807/1000 (80.7%)  wall=1215.0s  tps≈  680.2
[orchard][ref_no_flash_mac1-3_bf16] step 814/1000 (81.4%)  wall=1225.2s  tps≈  680.3
[orchard][ref_no_flash_mac1-3_bf16] step 821/1000 (82.1%)  wall=1235.4s  tps≈  680.5
[orchard][ref_no_flash_mac1-3_bf16] step 828/1000 (82.8%)  wall=1245.6s  tps≈  680.7
[orchard][ref_no_flash_mac1-3_bf16] step 835/1000 (83.5%)  wall=1255.8s  tps≈  680.9
[orchard][ref_no_flash_mac1-3_bf16] step 842/1000 (84.2%)  wall=1266.0s  tps≈  681.0
[orchard][ref_no_flash_mac1-3_bf16] step 849/1000 (84.9%)  wall=1276.3s  tps≈  681.2
[orchard][ref_no_flash_mac1-3_bf16] step 856/1000 (85.6%)  wall=1286.5s  tps≈  681.4
[orchard][ref_no_flash_mac1-3_bf16] step 863/1000 (86.3%)  wall=1296.8s  tps≈  681.5
[orchard][ref_no_flash_mac1-3_bf16] step 870/1000 (87.0%)  wall=1307.0s  tps≈  681.6
[orchard][ref_no_flash_mac1-3_bf16] step 877/1000 (87.7%)  wall=1317.5s  tps≈  681.6
[orchard][ref_no_flash_mac1-3_bf16] step 884/1000 (88.4%)  wall=1327.6s  tps≈  681.8
[orchard][ref_no_flash_mac1-3_bf16] step 891/1000 (89.1%)  wall=1338.0s  tps≈  681.9
[orchard][ref_no_flash_mac1-3_bf16] step 898/1000 (89.8%)  wall=1348.3s  tps≈  682.0
[orchard][ref_no_flash_mac1-3_bf16] step 905/1000 (90.5%)  wall=1358.5s  tps≈  682.2
[orchard][ref_no_flash_mac1-3_bf16] step 912/1000 (91.2%)  wall=1369.0s  tps≈  682.2
[orchard][ref_no_flash_mac1-3_bf16] step 919/1000 (91.9%)  wall=1379.4s  tps≈  682.2
[orchard][ref_no_flash_mac1-3_bf16] step 926/1000 (92.6%)  wall=1389.6s  tps≈  682.4
[orchard][ref_no_flash_mac1-3_bf16] step 933/1000 (93.3%)  wall=1399.8s  tps≈  682.5
[orchard][ref_no_flash_mac1-3_bf16] step 940/1000 (94.0%)  wall=1410.4s  tps≈  682.5
[orchard][ref_no_flash_mac1-3_bf16] step 947/1000 (94.7%)  wall=1420.8s  tps≈  682.5
[orchard][ref_no_flash_mac1-3_bf16] step 954/1000 (95.4%)  wall=1431.0s  tps≈  682.7
[orchard][ref_no_flash_mac1-3_bf16] step 960/1000 (96.0%)  wall=1441.5s  tps≈  682.0
[orchard][ref_no_flash_mac1-3_bf16] step 967/1000 (96.7%)  wall=1452.8s  tps≈  681.6
[orchard][ref_no_flash_mac1-3_bf16] step 973/1000 (97.3%)  wall=1463.0s  tps≈  681.1
[orchard][ref_no_flash_mac1-3_bf16] step 980/1000 (98.0%)  wall=1474.2s  tps≈  680.7
[orchard][ref_no_flash_mac1-3_bf16] step 987/1000 (98.7%)  wall=1484.8s  tps≈  680.7
[orchard][ref_no_flash_mac1-3_bf16] step 994/1000 (99.4%)  wall=1495.4s  tps≈  680.7
[orchard][ref_no_flash_mac1-3_bf16] step 1000/1000 (100.0%)  wall=1504.4s  tps≈  680.7
JSON:{"schema": "orchard_bench_v1", "tag": "ref_no_flash_mac1-3_bf16", "commit": "34969e4", "dataset_sha": "57f3eb280cfe78d8cebe3aa76d7416607845416e22464dd9709ccb487f8d7b92", "batch": 2, "seq": 512, "micro_steps": 1000, "total_tokens": 1024000, "throughput_tps": 680.447931457059, "tokenize_s": 6.9103, "copy_s": 23.5856, "copy_mb_s": 0.35, "train_s": 0.0, "host_to_gpu_mb": 8.19, "avg_loss_stub": 0.5746824797387234, "max_grad": 159.0, "dtype": "torch.bfloat16", "bf16": true, "flash": {"enabled": false}, "metal_ver": "32023.620", "seed": 42, "timeline": [], "avg_gpu_w": 5654.542452830188, "avg_gpu_temp": null}
