/Users/ianreitsma/projects/orchard/orchard-env/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
`loss_type=None` was set in the config but it is unrecognised.Using the default loss: `ForCausalLMLoss`.
[orchard][ref_no_flash_mac1-2_bf16] step 1/1000 ( 0.1%)  wall=   1.9s  tps≈  545.8
[orchard][ref_no_flash_mac1-2_bf16] step 8/1000 ( 0.8%)  wall=  12.5s  tps≈  655.8
[orchard][ref_no_flash_mac1-2_bf16] step 15/1000 ( 1.5%)  wall=  22.6s  tps≈  678.4
[orchard][ref_no_flash_mac1-2_bf16] step 22/1000 ( 2.2%)  wall=  32.8s  tps≈  686.3
[orchard][ref_no_flash_mac1-2_bf16] step 29/1000 ( 2.9%)  wall=  43.2s  tps≈  687.4
[orchard][ref_no_flash_mac1-2_bf16] step 36/1000 ( 3.6%)  wall=  53.3s  tps≈  691.3
[orchard][ref_no_flash_mac1-2_bf16] step 43/1000 ( 4.3%)  wall=  63.4s  tps≈  694.1
[orchard][ref_no_flash_mac1-2_bf16] step 50/1000 ( 5.0%)  wall=  73.6s  tps≈  696.0
[orchard][ref_no_flash_mac1-2_bf16] step 57/1000 ( 5.7%)  wall=  83.7s  tps≈  697.4
[orchard][ref_no_flash_mac1-2_bf16] step 64/1000 ( 6.4%)  wall=  93.9s  tps≈  697.8
[orchard][ref_no_flash_mac1-2_bf16] step 71/1000 ( 7.1%)  wall= 104.2s  tps≈  698.0
[orchard][ref_no_flash_mac1-2_bf16] step 78/1000 ( 7.8%)  wall= 114.3s  tps≈  698.9
[orchard][ref_no_flash_mac1-2_bf16] step 85/1000 ( 8.5%)  wall= 124.4s  tps≈  699.7
[orchard][ref_no_flash_mac1-2_bf16] step 92/1000 ( 9.2%)  wall= 134.6s  tps≈  700.1
[orchard][ref_no_flash_mac1-2_bf16] step 99/1000 ( 9.9%)  wall= 144.7s  tps≈  700.4
[orchard][ref_no_flash_mac1-2_bf16] step 106/1000 (10.6%)  wall= 154.9s  tps≈  700.8
[orchard][ref_no_flash_mac1-2_bf16] step 113/1000 (11.3%)  wall= 165.6s  tps≈  698.8
[orchard][ref_no_flash_mac1-2_bf16] step 120/1000 (12.0%)  wall= 176.5s  tps≈  696.2
[orchard][ref_no_flash_mac1-2_bf16] step 127/1000 (12.7%)  wall= 187.1s  tps≈  695.1
[orchard][ref_no_flash_mac1-2_bf16] step 134/1000 (13.4%)  wall= 197.3s  tps≈  695.5
[orchard][ref_no_flash_mac1-2_bf16] step 141/1000 (14.1%)  wall= 207.5s  tps≈  695.9
[orchard][ref_no_flash_mac1-2_bf16] step 148/1000 (14.8%)  wall= 217.6s  tps≈  696.5
[orchard][ref_no_flash_mac1-2_bf16] step 155/1000 (15.5%)  wall= 227.9s  tps≈  696.6
[orchard][ref_no_flash_mac1-2_bf16] step 162/1000 (16.2%)  wall= 238.0s  tps≈  697.1
[orchard][ref_no_flash_mac1-2_bf16] step 169/1000 (16.9%)  wall= 248.1s  tps≈  697.6
[orchard][ref_no_flash_mac1-2_bf16] step 176/1000 (17.6%)  wall= 258.3s  tps≈  697.8
[orchard][ref_no_flash_mac1-2_bf16] step 183/1000 (18.3%)  wall= 268.4s  tps≈  698.1
[orchard][ref_no_flash_mac1-2_bf16] step 190/1000 (19.0%)  wall= 278.6s  tps≈  698.4
[orchard][ref_no_flash_mac1-2_bf16] step 197/1000 (19.7%)  wall= 288.9s  tps≈  698.4
[orchard][ref_no_flash_mac1-2_bf16] step 204/1000 (20.4%)  wall= 299.0s  tps≈  698.6
[orchard][ref_no_flash_mac1-2_bf16] step 211/1000 (21.1%)  wall= 309.9s  tps≈  697.1
[orchard][ref_no_flash_mac1-2_bf16] step 218/1000 (21.8%)  wall= 320.9s  tps≈  695.7
[orchard][ref_no_flash_mac1-2_bf16] step 225/1000 (22.5%)  wall= 331.5s  tps≈  695.0
[orchard][ref_no_flash_mac1-2_bf16] step 232/1000 (23.2%)  wall= 342.0s  tps≈  694.7
[orchard][ref_no_flash_mac1-2_bf16] step 239/1000 (23.9%)  wall= 352.3s  tps≈  694.6
[orchard][ref_no_flash_mac1-2_bf16] step 246/1000 (24.6%)  wall= 362.7s  tps≈  694.6
[orchard][ref_no_flash_mac1-2_bf16] step 253/1000 (25.3%)  wall= 372.9s  tps≈  694.7
[orchard][ref_no_flash_mac1-2_bf16] step 260/1000 (26.0%)  wall= 383.1s  tps≈  694.9
[orchard][ref_no_flash_mac1-2_bf16] step 267/1000 (26.7%)  wall= 393.5s  tps≈  694.9
[orchard][ref_no_flash_mac1-2_bf16] step 274/1000 (27.4%)  wall= 404.0s  tps≈  694.4
[orchard][ref_no_flash_mac1-2_bf16] step 281/1000 (28.1%)  wall= 414.5s  tps≈  694.2
[orchard][ref_no_flash_mac1-2_bf16] step 288/1000 (28.8%)  wall= 424.8s  tps≈  694.3
[orchard][ref_no_flash_mac1-2_bf16] step 295/1000 (29.5%)  wall= 435.0s  tps≈  694.5
[orchard][ref_no_flash_mac1-2_bf16] step 302/1000 (30.2%)  wall= 445.2s  tps≈  694.6
[orchard][ref_no_flash_mac1-2_bf16] step 309/1000 (30.9%)  wall= 455.4s  tps≈  694.8
[orchard][ref_no_flash_mac1-2_bf16] step 316/1000 (31.6%)  wall= 465.7s  tps≈  694.8
[orchard][ref_no_flash_mac1-2_bf16] step 323/1000 (32.3%)  wall= 475.9s  tps≈  695.1
[orchard][ref_no_flash_mac1-2_bf16] step 330/1000 (33.0%)  wall= 486.0s  tps≈  695.3
[orchard][ref_no_flash_mac1-2_bf16] step 337/1000 (33.7%)  wall= 496.4s  tps≈  695.2
[orchard][ref_no_flash_mac1-2_bf16] step 344/1000 (34.4%)  wall= 506.8s  tps≈  695.1
[orchard][ref_no_flash_mac1-2_bf16] step 351/1000 (35.1%)  wall= 517.0s  tps≈  695.1
[orchard][ref_no_flash_mac1-2_bf16] step 358/1000 (35.8%)  wall= 527.2s  tps≈  695.3
[orchard][ref_no_flash_mac1-2_bf16] step 365/1000 (36.5%)  wall= 537.5s  tps≈  695.4
[orchard][ref_no_flash_mac1-2_bf16] step 372/1000 (37.2%)  wall= 547.6s  tps≈  695.6
[orchard][ref_no_flash_mac1-2_bf16] step 379/1000 (37.9%)  wall= 557.8s  tps≈  695.8
[orchard][ref_no_flash_mac1-2_bf16] step 386/1000 (38.6%)  wall= 567.9s  tps≈  696.0
[orchard][ref_no_flash_mac1-2_bf16] step 393/1000 (39.3%)  wall= 578.3s  tps≈  695.9
[orchard][ref_no_flash_mac1-2_bf16] step 400/1000 (40.0%)  wall= 588.4s  tps≈  696.1
[orchard][ref_no_flash_mac1-2_bf16] step 407/1000 (40.7%)  wall= 598.7s  tps≈  696.1
[orchard][ref_no_flash_mac1-2_bf16] step 414/1000 (41.4%)  wall= 609.8s  tps≈  695.2
[orchard][ref_no_flash_mac1-2_bf16] step 421/1000 (42.1%)  wall= 621.0s  tps≈  694.2
[orchard][ref_no_flash_mac1-2_bf16] step 428/1000 (42.8%)  wall= 631.3s  tps≈  694.2
[orchard][ref_no_flash_mac1-2_bf16] step 435/1000 (43.5%)  wall= 641.8s  tps≈  694.0
[orchard][ref_no_flash_mac1-2_bf16] step 442/1000 (44.2%)  wall= 652.5s  tps≈  693.7
[orchard][ref_no_flash_mac1-2_bf16] step 449/1000 (44.9%)  wall= 662.8s  tps≈  693.7
[orchard][ref_no_flash_mac1-2_bf16] step 456/1000 (45.6%)  wall= 672.9s  tps≈  693.9
[orchard][ref_no_flash_mac1-2_bf16] step 463/1000 (46.3%)  wall= 683.2s  tps≈  694.0
[orchard][ref_no_flash_mac1-2_bf16] step 470/1000 (47.0%)  wall= 693.4s  tps≈  694.1
[orchard][ref_no_flash_mac1-2_bf16] step 477/1000 (47.7%)  wall= 703.6s  tps≈  694.2
[orchard][ref_no_flash_mac1-2_bf16] step 484/1000 (48.4%)  wall= 713.8s  tps≈  694.3
[orchard][ref_no_flash_mac1-2_bf16] step 491/1000 (49.1%)  wall= 724.1s  tps≈  694.4
[orchard][ref_no_flash_mac1-2_bf16] step 498/1000 (49.8%)  wall= 734.3s  tps≈  694.5
[orchard][ref_no_flash_mac1-2_bf16] step 505/1000 (50.5%)  wall= 744.4s  tps≈  694.7
[orchard][ref_no_flash_mac1-2_bf16] step 512/1000 (51.2%)  wall= 754.5s  tps≈  694.8
[orchard][ref_no_flash_mac1-2_bf16] step 519/1000 (51.9%)  wall= 764.7s  tps≈  695.0
[orchard][ref_no_flash_mac1-2_bf16] step 526/1000 (52.6%)  wall= 774.8s  tps≈  695.2
[orchard][ref_no_flash_mac1-2_bf16] step 533/1000 (53.3%)  wall= 785.1s  tps≈  695.2
[orchard][ref_no_flash_mac1-2_bf16] step 540/1000 (54.0%)  wall= 795.5s  tps≈  695.1
[orchard][ref_no_flash_mac1-2_bf16] step 547/1000 (54.7%)  wall= 805.7s  tps≈  695.2
[orchard][ref_no_flash_mac1-2_bf16] step 554/1000 (55.4%)  wall= 815.9s  tps≈  695.3
[orchard][ref_no_flash_mac1-2_bf16] step 561/1000 (56.1%)  wall= 826.1s  tps≈  695.4
[orchard][ref_no_flash_mac1-2_bf16] step 568/1000 (56.8%)  wall= 836.4s  tps≈  695.4
[orchard][ref_no_flash_mac1-2_bf16] step 575/1000 (57.5%)  wall= 846.6s  tps≈  695.5
[orchard][ref_no_flash_mac1-2_bf16] step 582/1000 (58.2%)  wall= 857.0s  tps≈  695.4
[orchard][ref_no_flash_mac1-2_bf16] step 589/1000 (58.9%)  wall= 867.2s  tps≈  695.5
[orchard][ref_no_flash_mac1-2_bf16] step 596/1000 (59.6%)  wall= 877.4s  tps≈  695.6
[orchard][ref_no_flash_mac1-2_bf16] step 603/1000 (60.3%)  wall= 887.5s  tps≈  695.7
[orchard][ref_no_flash_mac1-2_bf16] step 610/1000 (61.0%)  wall= 897.7s  tps≈  695.8
[orchard][ref_no_flash_mac1-2_bf16] step 617/1000 (61.7%)  wall= 907.8s  tps≈  695.9
[orchard][ref_no_flash_mac1-2_bf16] step 624/1000 (62.4%)  wall= 918.2s  tps≈  695.9
[orchard][ref_no_flash_mac1-2_bf16] step 631/1000 (63.1%)  wall= 928.4s  tps≈  696.0
[orchard][ref_no_flash_mac1-2_bf16] step 638/1000 (63.8%)  wall= 938.7s  tps≈  696.0
[orchard][ref_no_flash_mac1-2_bf16] step 645/1000 (64.5%)  wall= 948.9s  tps≈  696.1
[orchard][ref_no_flash_mac1-2_bf16] step 652/1000 (65.2%)  wall= 959.0s  tps≈  696.2
[orchard][ref_no_flash_mac1-2_bf16] step 659/1000 (65.9%)  wall= 969.2s  tps≈  696.3
[orchard][ref_no_flash_mac1-2_bf16] step 666/1000 (66.6%)  wall= 979.4s  tps≈  696.3
[orchard][ref_no_flash_mac1-2_bf16] step 673/1000 (67.3%)  wall= 989.5s  tps≈  696.4
[orchard][ref_no_flash_mac1-2_bf16] step 680/1000 (68.0%)  wall= 999.7s  tps≈  696.5
[orchard][ref_no_flash_mac1-2_bf16] step 687/1000 (68.7%)  wall=1009.9s  tps≈  696.6
[orchard][ref_no_flash_mac1-2_bf16] step 694/1000 (69.4%)  wall=1020.1s  tps≈  696.7
[orchard][ref_no_flash_mac1-2_bf16] step 701/1000 (70.1%)  wall=1030.2s  tps≈  696.8
[orchard][ref_no_flash_mac1-2_bf16] step 708/1000 (70.8%)  wall=1040.4s  tps≈  696.8
[orchard][ref_no_flash_mac1-2_bf16] step 715/1000 (71.5%)  wall=1050.5s  tps≈  696.9
[orchard][ref_no_flash_mac1-2_bf16] step 722/1000 (72.2%)  wall=1060.7s  tps≈  697.0
[orchard][ref_no_flash_mac1-2_bf16] step 729/1000 (72.9%)  wall=1071.0s  tps≈  697.0
[orchard][ref_no_flash_mac1-2_bf16] step 736/1000 (73.6%)  wall=1081.3s  tps≈  697.0
[orchard][ref_no_flash_mac1-2_bf16] step 743/1000 (74.3%)  wall=1091.4s  tps≈  697.1
[orchard][ref_no_flash_mac1-2_bf16] step 750/1000 (75.0%)  wall=1101.7s  tps≈  697.1
[orchard][ref_no_flash_mac1-2_bf16] step 757/1000 (75.7%)  wall=1112.1s  tps≈  697.1
[orchard][ref_no_flash_mac1-2_bf16] step 764/1000 (76.4%)  wall=1122.2s  tps≈  697.1
[orchard][ref_no_flash_mac1-2_bf16] step 771/1000 (77.1%)  wall=1132.5s  tps≈  697.2
[orchard][ref_no_flash_mac1-2_bf16] step 778/1000 (77.8%)  wall=1142.8s  tps≈  697.1
[orchard][ref_no_flash_mac1-2_bf16] step 785/1000 (78.5%)  wall=1153.5s  tps≈  696.8
[orchard][ref_no_flash_mac1-2_bf16] step 792/1000 (79.2%)  wall=1163.8s  tps≈  696.9
[orchard][ref_no_flash_mac1-2_bf16] step 799/1000 (79.9%)  wall=1174.0s  tps≈  696.9
[orchard][ref_no_flash_mac1-2_bf16] step 806/1000 (80.6%)  wall=1184.1s  tps≈  697.0
[orchard][ref_no_flash_mac1-2_bf16] step 813/1000 (81.3%)  wall=1194.2s  tps≈  697.1
[orchard][ref_no_flash_mac1-2_bf16] step 820/1000 (82.0%)  wall=1204.5s  tps≈  697.1
[orchard][ref_no_flash_mac1-2_bf16] step 827/1000 (82.7%)  wall=1214.8s  tps≈  697.1
[orchard][ref_no_flash_mac1-2_bf16] step 834/1000 (83.4%)  wall=1225.1s  tps≈  697.1
[orchard][ref_no_flash_mac1-2_bf16] step 841/1000 (84.1%)  wall=1235.4s  tps≈  697.1
[orchard][ref_no_flash_mac1-2_bf16] step 848/1000 (84.8%)  wall=1245.7s  tps≈  697.1
[orchard][ref_no_flash_mac1-2_bf16] step 855/1000 (85.5%)  wall=1255.8s  tps≈  697.2
[orchard][ref_no_flash_mac1-2_bf16] step 862/1000 (86.2%)  wall=1266.0s  tps≈  697.2
[orchard][ref_no_flash_mac1-2_bf16] step 869/1000 (86.9%)  wall=1276.2s  tps≈  697.3
[orchard][ref_no_flash_mac1-2_bf16] step 876/1000 (87.6%)  wall=1286.3s  tps≈  697.4
[orchard][ref_no_flash_mac1-2_bf16] step 883/1000 (88.3%)  wall=1296.5s  tps≈  697.4
[orchard][ref_no_flash_mac1-2_bf16] step 890/1000 (89.0%)  wall=1306.6s  tps≈  697.5
[orchard][ref_no_flash_mac1-2_bf16] step 897/1000 (89.7%)  wall=1316.9s  tps≈  697.5
[orchard][ref_no_flash_mac1-2_bf16] step 904/1000 (90.4%)  wall=1327.1s  tps≈  697.5
[orchard][ref_no_flash_mac1-2_bf16] step 911/1000 (91.1%)  wall=1337.2s  tps≈  697.6
[orchard][ref_no_flash_mac1-2_bf16] step 918/1000 (91.8%)  wall=1347.3s  tps≈  697.7
[orchard][ref_no_flash_mac1-2_bf16] step 925/1000 (92.5%)  wall=1357.5s  tps≈  697.8
[orchard][ref_no_flash_mac1-2_bf16] step 932/1000 (93.2%)  wall=1367.6s  tps≈  697.8
[orchard][ref_no_flash_mac1-2_bf16] step 939/1000 (93.9%)  wall=1377.8s  tps≈  697.9
[orchard][ref_no_flash_mac1-2_bf16] step 946/1000 (94.6%)  wall=1387.9s  tps≈  697.9
[orchard][ref_no_flash_mac1-2_bf16] step 953/1000 (95.3%)  wall=1398.1s  tps≈  698.0
[orchard][ref_no_flash_mac1-2_bf16] step 960/1000 (96.0%)  wall=1408.3s  tps≈  698.1
[orchard][ref_no_flash_mac1-2_bf16] step 967/1000 (96.7%)  wall=1418.4s  tps≈  698.1
[orchard][ref_no_flash_mac1-2_bf16] step 974/1000 (97.4%)  wall=1428.9s  tps≈  698.0
[orchard][ref_no_flash_mac1-2_bf16] step 981/1000 (98.1%)  wall=1439.2s  tps≈  698.0
[orchard][ref_no_flash_mac1-2_bf16] step 988/1000 (98.8%)  wall=1449.5s  tps≈  698.0
[orchard][ref_no_flash_mac1-2_bf16] step 995/1000 (99.5%)  wall=1459.8s  tps≈  698.0
[orchard][ref_no_flash_mac1-2_bf16] step 1000/1000 (100.0%)  wall=1467.1s  tps≈  698.0
JSON:{"schema": "orchard_bench_v1", "tag": "ref_no_flash_mac1-2_bf16", "commit": "34969e4", "dataset_sha": "57f3eb280cfe78d8cebe3aa76d7416607845416e22464dd9709ccb487f8d7b92", "batch": 2, "seq": 512, "micro_steps": 1000, "total_tokens": 1024000, "throughput_tps": 697.8411132261845, "tokenize_s": 6.2225, "copy_s": 22.1557, "copy_mb_s": 0.37, "train_s": 0.0, "host_to_gpu_mb": 8.19, "avg_loss_stub": 0.5746824797387234, "max_grad": 159.0, "dtype": "torch.bfloat16", "bf16": true, "flash": {"enabled": false}, "metal_ver": "32023.620", "seed": 42, "timeline": [], "avg_gpu_w": 5843.676085458304, "avg_gpu_temp": null}
