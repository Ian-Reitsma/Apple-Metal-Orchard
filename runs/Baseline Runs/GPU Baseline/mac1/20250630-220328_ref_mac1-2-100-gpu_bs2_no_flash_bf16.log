/Users/ianreitsma/projects/orchard/orchard-env/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
MPS available: True MPS built: True
`loss_type=None` was set in the config but it is unrecognised.Using the default loss: `ForCausalLMLoss`.
[orchard][ref_mac1-2-100-gpu_bs2_no_flash_bf16] step 1/100 ( 1.0%)  wall=   1.9s  tps≈  548.5
[orchard][ref_mac1-2-100-gpu_bs2_no_flash_bf16] step 8/100 ( 8.0%)  wall=  12.2s  tps≈  670.7
[orchard][ref_mac1-2-100-gpu_bs2_no_flash_bf16] step 15/100 (15.0%)  wall=  22.2s  tps≈  690.8
[orchard][ref_mac1-2-100-gpu_bs2_no_flash_bf16] step 22/100 (22.0%)  wall=  32.2s  tps≈  698.6
[orchard][ref_mac1-2-100-gpu_bs2_no_flash_bf16] step 30/100 (30.0%)  wall=  43.6s  tps≈  704.5
[orchard][ref_mac1-2-100-gpu_bs2_no_flash_bf16] step 38/100 (38.0%)  wall=  55.0s  tps≈  707.2
[orchard][ref_mac1-2-100-gpu_bs2_no_flash_bf16] step 45/100 (45.0%)  wall=  65.0s  tps≈  708.5
[orchard][ref_mac1-2-100-gpu_bs2_no_flash_bf16] step 53/100 (53.0%)  wall=  76.5s  tps≈  709.7
[orchard][ref_mac1-2-100-gpu_bs2_no_flash_bf16] step 61/100 (61.0%)  wall=  87.9s  tps≈  710.7
[orchard][ref_mac1-2-100-gpu_bs2_no_flash_bf16] step 69/100 (69.0%)  wall=  99.2s  tps≈  712.0
[orchard][ref_mac1-2-100-gpu_bs2_no_flash_bf16] step 76/100 (76.0%)  wall= 109.2s  tps≈  712.4
[orchard][ref_mac1-2-100-gpu_bs2_no_flash_bf16] step 83/100 (83.0%)  wall= 119.3s  tps≈  712.6
[orchard][ref_mac1-2-100-gpu_bs2_no_flash_bf16] step 90/100 (90.0%)  wall= 129.3s  tps≈  712.6
[orchard][ref_mac1-2-100-gpu_bs2_no_flash_bf16] step 97/100 (97.0%)  wall= 139.4s  tps≈  712.4
[orchard][ref_mac1-2-100-gpu_bs2_no_flash_bf16] step 100/100 (100.0%)  wall= 143.7s  tps≈  712.5
JSON:{"schema": "orchard_bench_v1", "tag": "ref_mac1-2-100-gpu_bs2_no_flash_bf16", "commit": "d512501", "dataset_sha": "57f3eb280cfe78d8cebe3aa76d7416607845416e22464dd9709ccb487f8d7b92", "batch": 2, "seq": 512, "micro_steps": 100, "total_tokens": 102400, "throughput_tps": 711.4782379289438, "tokenize_s": 0.2749, "copy_s": 3.0979, "copy_mb_s": 0.26, "train_s": 0.0, "host_to_gpu_mb": 0.82, "avg_loss_stub": 0.8721076791360974, "max_grad": 159.0, "dtype": "torch.bfloat16", "bf16": true, "flash": {"enabled": false}, "metal_ver": "32023.620", "seed": 42, "timeline": [], "avg_gpu_w": 5589.197278911564, "avg_gpu_temp": null}
