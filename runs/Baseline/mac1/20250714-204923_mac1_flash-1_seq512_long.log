[orchard][flashpatch] FlashAttention monkeypatch ENABLED (GPT2Attention.forward, log=True, detail=False)
MPS available: True MPS built: True
[orchard] FlashAttention loaded (SHA e4dd5207…)
[orchard][flashpatch] --- FlashAttention Patch Context ---
  PATCH_ENABLED: True
  FLASHATTN_LOG_KERNEL: True
  FLASHATTN_LOG_DETAIL: False
  torch version: 2.7.1
  Model config (first layer): GPT2Config {
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 1024,
  "n_embd": 768,
  "n_head": 12,
  "n_inner": null,
  "n_layer": 12,
  "n_positions": 1024,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "torch_dtype": "float32",
  "transformers_version": "4.53.0",
  "use_cache": true,
  "vocab_size": 50257
}

  Example Q shape: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16, device: mps:0
  ENV: USE_FLASH_ATTN=1, PYTHONHASHSEED=None
-------------------------------------------------------------
`loss_type=None` was set in the config but it is unrecognised.Using the default loss: `ForCausalLMLoss`.
[orchard][mac1_flash-1_seq512_long] step 1/1000 ( 0.1%)  wall=   1.8s  tps≈  576.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 9/1000 ( 0.9%)  wall=  12.6s  tps≈  729.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 17/1000 ( 1.7%)  wall=  23.3s  tps≈  747.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 25/1000 ( 2.5%)  wall=  34.1s  tps≈  751.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 33/1000 ( 3.3%)  wall=  44.7s  tps≈  755.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 41/1000 ( 4.1%)  wall=  55.4s  tps≈  757.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 49/1000 ( 4.9%)  wall=  66.2s  tps≈  758.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 56/1000 ( 5.6%)  wall=  76.2s  tps≈  752.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 64/1000 ( 6.4%)  wall=  87.0s  tps≈  753.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 72/1000 ( 7.2%)  wall=  97.6s  tps≈  755.0
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 80/1000 ( 8.0%)  wall= 108.3s  tps≈  756.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 88/1000 ( 8.8%)  wall= 119.0s  tps≈  757.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 96/1000 ( 9.6%)  wall= 129.7s  tps≈  757.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 104/1000 (10.4%)  wall= 140.5s  tps≈  758.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 112/1000 (11.2%)  wall= 151.2s  tps≈  758.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 120/1000 (12.0%)  wall= 162.0s  tps≈  758.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 128/1000 (12.8%)  wall= 172.7s  tps≈  758.9
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 136/1000 (13.6%)  wall= 183.5s  tps≈  759.0
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 144/1000 (14.4%)  wall= 194.2s  tps≈  759.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 152/1000 (15.2%)  wall= 205.0s  tps≈  759.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 160/1000 (16.0%)  wall= 215.7s  tps≈  759.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 168/1000 (16.8%)  wall= 226.5s  tps≈  759.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 176/1000 (17.6%)  wall= 237.2s  tps≈  759.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 184/1000 (18.4%)  wall= 247.9s  tps≈  759.9
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 192/1000 (19.2%)  wall= 258.7s  tps≈  760.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 200/1000 (20.0%)  wall= 269.4s  tps≈  760.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 208/1000 (20.8%)  wall= 280.2s  tps≈  760.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 216/1000 (21.6%)  wall= 290.9s  tps≈  760.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 224/1000 (22.4%)  wall= 301.7s  tps≈  760.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 232/1000 (23.2%)  wall= 312.5s  tps≈  760.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 240/1000 (24.0%)  wall= 323.3s  tps≈  760.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 248/1000 (24.8%)  wall= 334.0s  tps≈  760.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 256/1000 (25.6%)  wall= 344.7s  tps≈  760.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 264/1000 (26.4%)  wall= 355.4s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 272/1000 (27.2%)  wall= 366.2s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 280/1000 (28.0%)  wall= 377.0s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 288/1000 (28.8%)  wall= 387.7s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 296/1000 (29.6%)  wall= 398.5s  tps≈  760.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 304/1000 (30.4%)  wall= 409.2s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 312/1000 (31.2%)  wall= 419.9s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 320/1000 (32.0%)  wall= 430.7s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 328/1000 (32.8%)  wall= 441.4s  tps≈  760.9
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 336/1000 (33.6%)  wall= 452.1s  tps≈  761.0
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 344/1000 (34.4%)  wall= 462.9s  tps≈  761.0
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 352/1000 (35.2%)  wall= 473.6s  tps≈  761.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 360/1000 (36.0%)  wall= 484.3s  tps≈  761.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 368/1000 (36.8%)  wall= 495.0s  tps≈  761.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 376/1000 (37.6%)  wall= 505.7s  tps≈  761.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 384/1000 (38.4%)  wall= 516.5s  tps≈  761.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 392/1000 (39.2%)  wall= 527.2s  tps≈  761.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 400/1000 (40.0%)  wall= 537.9s  tps≈  761.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 408/1000 (40.8%)  wall= 548.6s  tps≈  761.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 416/1000 (41.6%)  wall= 559.3s  tps≈  761.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 424/1000 (42.4%)  wall= 570.1s  tps≈  761.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 432/1000 (43.2%)  wall= 580.8s  tps≈  761.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 440/1000 (44.0%)  wall= 591.6s  tps≈  761.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 448/1000 (44.8%)  wall= 602.5s  tps≈  761.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 456/1000 (45.6%)  wall= 613.4s  tps≈  761.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 464/1000 (46.4%)  wall= 624.7s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 472/1000 (47.2%)  wall= 635.8s  tps≈  760.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 480/1000 (48.0%)  wall= 646.6s  tps≈  760.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 488/1000 (48.8%)  wall= 657.7s  tps≈  759.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 496/1000 (49.6%)  wall= 668.9s  tps≈  759.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 504/1000 (50.4%)  wall= 679.7s  tps≈  759.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 512/1000 (51.2%)  wall= 690.4s  tps≈  759.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 520/1000 (52.0%)  wall= 701.1s  tps≈  759.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 528/1000 (52.8%)  wall= 711.8s  tps≈  759.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 536/1000 (53.6%)  wall= 722.5s  tps≈  759.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 544/1000 (54.4%)  wall= 733.3s  tps≈  759.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 552/1000 (55.2%)  wall= 744.0s  tps≈  759.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 560/1000 (56.0%)  wall= 754.7s  tps≈  759.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 568/1000 (56.8%)  wall= 765.5s  tps≈  759.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 576/1000 (57.6%)  wall= 776.2s  tps≈  759.9
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 584/1000 (58.4%)  wall= 787.0s  tps≈  759.9
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 592/1000 (59.2%)  wall= 797.7s  tps≈  759.9
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 600/1000 (60.0%)  wall= 808.5s  tps≈  760.0
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 608/1000 (60.8%)  wall= 819.2s  tps≈  760.0
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 616/1000 (61.6%)  wall= 829.9s  tps≈  760.0
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 624/1000 (62.4%)  wall= 840.7s  tps≈  760.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 632/1000 (63.2%)  wall= 851.4s  tps≈  760.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 640/1000 (64.0%)  wall= 862.1s  tps≈  760.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 648/1000 (64.8%)  wall= 872.8s  tps≈  760.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 656/1000 (65.6%)  wall= 883.5s  tps≈  760.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 664/1000 (66.4%)  wall= 894.2s  tps≈  760.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 672/1000 (67.2%)  wall= 905.0s  tps≈  760.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 680/1000 (68.0%)  wall= 915.8s  tps≈  760.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 688/1000 (68.8%)  wall= 926.5s  tps≈  760.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 696/1000 (69.6%)  wall= 937.3s  tps≈  760.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 704/1000 (70.4%)  wall= 948.0s  tps≈  760.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 712/1000 (71.2%)  wall= 958.7s  tps≈  760.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 720/1000 (72.0%)  wall= 969.6s  tps≈  760.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 728/1000 (72.8%)  wall= 980.3s  tps≈  760.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 736/1000 (73.6%)  wall= 991.0s  tps≈  760.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 744/1000 (74.4%)  wall=1001.8s  tps≈  760.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 752/1000 (75.2%)  wall=1012.5s  tps≈  760.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 760/1000 (76.0%)  wall=1023.3s  tps≈  760.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 768/1000 (76.8%)  wall=1034.1s  tps≈  760.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 776/1000 (77.6%)  wall=1044.8s  tps≈  760.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 784/1000 (78.4%)  wall=1055.6s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 792/1000 (79.2%)  wall=1066.3s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 800/1000 (80.0%)  wall=1077.1s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 808/1000 (80.8%)  wall=1087.8s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 816/1000 (81.6%)  wall=1098.6s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 824/1000 (82.4%)  wall=1109.3s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 832/1000 (83.2%)  wall=1120.1s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 840/1000 (84.0%)  wall=1130.8s  tps≈  760.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 848/1000 (84.8%)  wall=1141.6s  tps≈  760.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 856/1000 (85.6%)  wall=1152.3s  tps≈  760.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 864/1000 (86.4%)  wall=1163.1s  tps≈  760.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 872/1000 (87.2%)  wall=1173.8s  tps≈  760.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 880/1000 (88.0%)  wall=1184.5s  tps≈  760.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 888/1000 (88.8%)  wall=1195.2s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 896/1000 (89.6%)  wall=1206.0s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 904/1000 (90.4%)  wall=1216.8s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 912/1000 (91.2%)  wall=1227.5s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 920/1000 (92.0%)  wall=1238.3s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 928/1000 (92.8%)  wall=1249.1s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 936/1000 (93.6%)  wall=1259.8s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 944/1000 (94.4%)  wall=1270.5s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 952/1000 (95.2%)  wall=1281.3s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 960/1000 (96.0%)  wall=1292.0s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 968/1000 (96.8%)  wall=1302.8s  tps≈  760.9
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 976/1000 (97.6%)  wall=1313.6s  tps≈  760.9
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 984/1000 (98.4%)  wall=1324.6s  tps≈  760.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 992/1000 (99.2%)  wall=1335.7s  tps≈  760.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][mac1_flash-1_seq512_long] step 1000/1000 (100.0%)  wall=1346.9s  tps≈  760.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
JSON:{"schema": "orchard_bench_v1", "tag": "mac1_flash-1_seq512_long", "commit": "53420a5", "dataset_sha": "57f3eb280cfe78d8cebe3aa76d7416607845416e22464dd9709ccb487f8d7b92", "batch": 2, "seq": 512, "micro_steps": 1000, "total_tokens": 1024000, "throughput_tps": 760.1392337973674, "tokenize_s": 0.922, "copy_s": 29.3055, "copy_mb_s": 0.28, "train_s": 0.0, "host_to_gpu_mb": 8.19, "avg_loss_stub": 0.5532580571686849, "max_grad": 168.0, "dtype": "torch.bfloat16", "bf16": true, "flash": {"enabled": true, "sha": "e4dd520784c547b9cebf18d82638e14937e4642232259047cf398a312d37822d", "built": "2025-07-12T23:47:23", "metal": "32023.620"}, "metal_ver": "32023.620", "seed": 42, "timeline": [], "avg_gpu_w": 6250.306390977444, "grad_accum": 1, "avg_gpu_temp": null}
