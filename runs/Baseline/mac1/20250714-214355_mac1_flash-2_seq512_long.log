[orchard][flashpatch] FlashAttention monkeypatch ENABLED (GPT2Attention.forward, log=True, detail=False)
MPS available: True MPS built: True
[orchard] FlashAttention loaded (SHA e4dd5207…)
[orchard][flashpatch] --- FlashAttention Patch Context ---
  PATCH_ENABLED: True
  FLASHATTN_LOG_KERNEL: True
  FLASHATTN_LOG_DETAIL: False
  torch version: 2.7.1
  Model config (first layer): GPT2Config {
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 1024,
  "n_embd": 768,
  "n_head": 12,
  "n_inner": null,
  "n_layer": 12,
  "n_positions": 1024,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "torch_dtype": "float32",
  "transformers_version": "4.53.0",
  "use_cache": true,
  "vocab_size": 50257
}

  Example Q shape: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16, device: mps:0
  ENV: USE_FLASH_ATTN=1, PYTHONHASHSEED=None
-------------------------------------------------------------
`loss_type=None` was set in the config but it is unrecognised.Using the default loss: `ForCausalLMLoss`.
[orchard][mac1_flash-2_seq512_long] step 1/1000 ( 0.1%)  wall=   1.8s  tps≈  553.8
[orchard][mac1_flash-2_seq512_long] step 9/1000 ( 0.9%)  wall=  12.6s  tps≈  733.2
[orchard][mac1_flash-2_seq512_long] step 17/1000 ( 1.7%)  wall=  23.4s  tps≈  745.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 25/1000 ( 2.5%)  wall=  34.1s  tps≈  751.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 33/1000 ( 3.3%)  wall=  44.8s  tps≈  754.3
[orchard][mac1_flash-2_seq512_long] step 41/1000 ( 4.1%)  wall=  55.6s  tps≈  755.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 49/1000 ( 4.9%)  wall=  66.2s  tps≈  757.7
[orchard][mac1_flash-2_seq512_long] step 57/1000 ( 5.7%)  wall=  77.0s  tps≈  758.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 65/1000 ( 6.5%)  wall=  88.1s  tps≈  755.7
[orchard][mac1_flash-2_seq512_long] step 73/1000 ( 7.3%)  wall=  99.2s  tps≈  753.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 81/1000 ( 8.1%)  wall= 110.0s  tps≈  753.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 89/1000 ( 8.9%)  wall= 120.7s  tps≈  755.0
[orchard][mac1_flash-2_seq512_long] step 97/1000 ( 9.7%)  wall= 131.3s  tps≈  756.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 105/1000 (10.5%)  wall= 142.0s  tps≈  757.4
[orchard][mac1_flash-2_seq512_long] step 113/1000 (11.3%)  wall= 152.7s  tps≈  758.0
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 121/1000 (12.1%)  wall= 163.4s  tps≈  758.4
[orchard][mac1_flash-2_seq512_long] step 129/1000 (12.9%)  wall= 174.1s  tps≈  758.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 137/1000 (13.7%)  wall= 184.9s  tps≈  758.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 145/1000 (14.5%)  wall= 195.6s  tps≈  758.9
[orchard][mac1_flash-2_seq512_long] step 153/1000 (15.3%)  wall= 206.4s  tps≈  759.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 161/1000 (16.1%)  wall= 217.1s  tps≈  759.5
[orchard][mac1_flash-2_seq512_long] step 169/1000 (16.9%)  wall= 227.8s  tps≈  759.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 177/1000 (17.7%)  wall= 238.6s  tps≈  759.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 185/1000 (18.5%)  wall= 249.3s  tps≈  759.7
[orchard][mac1_flash-2_seq512_long] step 193/1000 (19.3%)  wall= 260.1s  tps≈  759.9
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 201/1000 (20.1%)  wall= 270.8s  tps≈  759.9
[orchard][mac1_flash-2_seq512_long] step 209/1000 (20.9%)  wall= 281.6s  tps≈  760.0
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 217/1000 (21.7%)  wall= 292.3s  tps≈  760.1
[orchard][mac1_flash-2_seq512_long] step 225/1000 (22.5%)  wall= 303.1s  tps≈  760.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 233/1000 (23.3%)  wall= 313.9s  tps≈  760.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 241/1000 (24.1%)  wall= 324.7s  tps≈  760.1
[orchard][mac1_flash-2_seq512_long] step 249/1000 (24.9%)  wall= 335.5s  tps≈  760.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 257/1000 (25.7%)  wall= 346.2s  tps≈  760.1
[orchard][mac1_flash-2_seq512_long] step 265/1000 (26.5%)  wall= 356.9s  tps≈  760.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 273/1000 (27.3%)  wall= 367.6s  tps≈  760.5
[orchard][mac1_flash-2_seq512_long] step 281/1000 (28.1%)  wall= 378.3s  tps≈  760.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 289/1000 (28.9%)  wall= 389.0s  tps≈  760.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 297/1000 (29.7%)  wall= 399.7s  tps≈  760.8
[orchard][mac1_flash-2_seq512_long] step 305/1000 (30.5%)  wall= 410.5s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 313/1000 (31.3%)  wall= 421.2s  tps≈  760.9
[orchard][mac1_flash-2_seq512_long] step 321/1000 (32.1%)  wall= 431.9s  tps≈  761.0
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 329/1000 (32.9%)  wall= 442.7s  tps≈  761.0
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 337/1000 (33.7%)  wall= 453.4s  tps≈  761.1
[orchard][mac1_flash-2_seq512_long] step 345/1000 (34.5%)  wall= 464.2s  tps≈  761.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 353/1000 (35.3%)  wall= 474.9s  tps≈  761.1
[orchard][mac1_flash-2_seq512_long] step 361/1000 (36.1%)  wall= 485.7s  tps≈  761.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 369/1000 (36.9%)  wall= 496.4s  tps≈  761.1
[orchard][mac1_flash-2_seq512_long] step 377/1000 (37.7%)  wall= 507.2s  tps≈  761.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 385/1000 (38.5%)  wall= 518.0s  tps≈  761.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 393/1000 (39.3%)  wall= 528.7s  tps≈  761.1
[orchard][mac1_flash-2_seq512_long] step 401/1000 (40.1%)  wall= 539.5s  tps≈  761.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 409/1000 (40.9%)  wall= 550.3s  tps≈  761.1
[orchard][mac1_flash-2_seq512_long] step 417/1000 (41.7%)  wall= 561.1s  tps≈  761.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 425/1000 (42.5%)  wall= 571.8s  tps≈  761.1
[orchard][mac1_flash-2_seq512_long] step 433/1000 (43.3%)  wall= 582.6s  tps≈  761.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 441/1000 (44.1%)  wall= 593.4s  tps≈  761.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 449/1000 (44.9%)  wall= 604.1s  tps≈  761.1
[orchard][mac1_flash-2_seq512_long] step 457/1000 (45.7%)  wall= 615.1s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 465/1000 (46.5%)  wall= 626.5s  tps≈  760.0
[orchard][mac1_flash-2_seq512_long] step 473/1000 (47.3%)  wall= 637.7s  tps≈  759.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 481/1000 (48.1%)  wall= 648.7s  tps≈  759.3
[orchard][mac1_flash-2_seq512_long] step 489/1000 (48.9%)  wall= 659.4s  tps≈  759.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 497/1000 (49.7%)  wall= 670.2s  tps≈  759.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 505/1000 (50.5%)  wall= 681.1s  tps≈  759.2
[orchard][mac1_flash-2_seq512_long] step 513/1000 (51.3%)  wall= 691.9s  tps≈  759.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 521/1000 (52.1%)  wall= 702.7s  tps≈  759.2
[orchard][mac1_flash-2_seq512_long] step 529/1000 (52.9%)  wall= 713.4s  tps≈  759.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 537/1000 (53.7%)  wall= 724.0s  tps≈  759.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 545/1000 (54.5%)  wall= 734.7s  tps≈  759.6
[orchard][mac1_flash-2_seq512_long] step 553/1000 (55.3%)  wall= 745.3s  tps≈  759.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 561/1000 (56.1%)  wall= 756.0s  tps≈  759.9
[orchard][mac1_flash-2_seq512_long] step 569/1000 (56.9%)  wall= 767.1s  tps≈  759.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 577/1000 (57.7%)  wall= 777.9s  tps≈  759.6
[orchard][mac1_flash-2_seq512_long] step 585/1000 (58.5%)  wall= 788.6s  tps≈  759.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 593/1000 (59.3%)  wall= 799.3s  tps≈  759.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 601/1000 (60.1%)  wall= 810.0s  tps≈  759.8
[orchard][mac1_flash-2_seq512_long] step 609/1000 (60.9%)  wall= 820.8s  tps≈  759.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 617/1000 (61.7%)  wall= 831.6s  tps≈  759.8
[orchard][mac1_flash-2_seq512_long] step 625/1000 (62.5%)  wall= 842.3s  tps≈  759.9
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 633/1000 (63.3%)  wall= 852.9s  tps≈  759.9
[orchard][mac1_flash-2_seq512_long] step 641/1000 (64.1%)  wall= 863.6s  tps≈  760.0
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 649/1000 (64.9%)  wall= 874.4s  tps≈  760.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 657/1000 (65.7%)  wall= 885.1s  tps≈  760.1
[orchard][mac1_flash-2_seq512_long] step 665/1000 (66.5%)  wall= 895.9s  tps≈  760.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 673/1000 (67.3%)  wall= 906.6s  tps≈  760.1
[orchard][mac1_flash-2_seq512_long] step 681/1000 (68.1%)  wall= 917.3s  tps≈  760.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 689/1000 (68.9%)  wall= 928.1s  tps≈  760.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 697/1000 (69.7%)  wall= 938.8s  tps≈  760.2
[orchard][mac1_flash-2_seq512_long] step 705/1000 (70.5%)  wall= 949.6s  tps≈  760.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 713/1000 (71.3%)  wall= 960.3s  tps≈  760.3
[orchard][mac1_flash-2_seq512_long] step 721/1000 (72.1%)  wall= 971.1s  tps≈  760.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 729/1000 (72.9%)  wall= 981.8s  tps≈  760.3
[orchard][mac1_flash-2_seq512_long] step 737/1000 (73.7%)  wall= 992.5s  tps≈  760.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 745/1000 (74.5%)  wall=1003.3s  tps≈  760.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 753/1000 (75.3%)  wall=1014.0s  tps≈  760.4
[orchard][mac1_flash-2_seq512_long] step 761/1000 (76.1%)  wall=1024.8s  tps≈  760.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 769/1000 (76.9%)  wall=1035.5s  tps≈  760.5
[orchard][mac1_flash-2_seq512_long] step 777/1000 (77.7%)  wall=1046.3s  tps≈  760.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 785/1000 (78.5%)  wall=1057.0s  tps≈  760.5
[orchard][mac1_flash-2_seq512_long] step 793/1000 (79.3%)  wall=1067.8s  tps≈  760.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 801/1000 (80.1%)  wall=1078.6s  tps≈  760.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 809/1000 (80.9%)  wall=1089.3s  tps≈  760.5
[orchard][mac1_flash-2_seq512_long] step 817/1000 (81.7%)  wall=1100.1s  tps≈  760.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 825/1000 (82.5%)  wall=1110.8s  tps≈  760.5
[orchard][mac1_flash-2_seq512_long] step 833/1000 (83.3%)  wall=1121.6s  tps≈  760.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 841/1000 (84.1%)  wall=1132.3s  tps≈  760.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 849/1000 (84.9%)  wall=1143.1s  tps≈  760.5
[orchard][mac1_flash-2_seq512_long] step 857/1000 (85.7%)  wall=1153.8s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 865/1000 (86.5%)  wall=1164.6s  tps≈  760.6
[orchard][mac1_flash-2_seq512_long] step 873/1000 (87.3%)  wall=1175.4s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 881/1000 (88.1%)  wall=1186.1s  tps≈  760.6
[orchard][mac1_flash-2_seq512_long] step 889/1000 (88.9%)  wall=1196.8s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 897/1000 (89.7%)  wall=1207.6s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 905/1000 (90.5%)  wall=1218.3s  tps≈  760.6
[orchard][mac1_flash-2_seq512_long] step 913/1000 (91.3%)  wall=1229.1s  tps≈  760.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 921/1000 (92.1%)  wall=1239.8s  tps≈  760.7
[orchard][mac1_flash-2_seq512_long] step 929/1000 (92.9%)  wall=1250.5s  tps≈  760.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 937/1000 (93.7%)  wall=1261.3s  tps≈  760.7
[orchard][mac1_flash-2_seq512_long] step 945/1000 (94.5%)  wall=1272.0s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 953/1000 (95.3%)  wall=1282.8s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 961/1000 (96.1%)  wall=1293.5s  tps≈  760.8
[orchard][mac1_flash-2_seq512_long] step 969/1000 (96.9%)  wall=1304.3s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 977/1000 (97.7%)  wall=1315.0s  tps≈  760.8
[orchard][mac1_flash-2_seq512_long] step 985/1000 (98.5%)  wall=1325.7s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-2_seq512_long] step 993/1000 (99.3%)  wall=1336.5s  tps≈  760.8
[orchard][mac1_flash-2_seq512_long] step 1000/1000 (100.0%)  wall=1345.9s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
JSON:{"schema": "orchard_bench_v1", "tag": "mac1_flash-2_seq512_long", "commit": "53420a5", "dataset_sha": "57f3eb280cfe78d8cebe3aa76d7416607845416e22464dd9709ccb487f8d7b92", "batch": 2, "seq": 512, "micro_steps": 1000, "total_tokens": 1024000, "throughput_tps": 760.7256016083228, "tokenize_s": 1.0032, "copy_s": 29.5792, "copy_mb_s": 0.28, "train_s": 0.0, "host_to_gpu_mb": 8.19, "avg_loss_stub": 0.5532580571686849, "max_grad": 168.0, "dtype": "torch.bfloat16", "bf16": true, "flash": {"enabled": true, "sha": "e4dd520784c547b9cebf18d82638e14937e4642232259047cf398a312d37822d", "built": "2025-07-12T23:47:23", "metal": "32023.620"}, "metal_ver": "32023.620", "seed": 42, "timeline": [], "avg_gpu_w": 6240.584592145015, "grad_accum": 1, "avg_gpu_temp": null}
