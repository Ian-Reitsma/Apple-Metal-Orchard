[orchard][flashpatch] FlashAttention monkeypatch NOT ENABLED (USE_FLASH_ATTN!=1)
MPS available: True MPS built: True
`loss_type=None` was set in the config but it is unrecognised.Using the default loss: `ForCausalLMLoss`.
[orchard][mac1_baseline-3_seq512_long] step 1/1000 ( 0.1%)  wall=   1.9s  tps≈  543.8
[orchard][mac1_baseline-3_seq512_long] step 8/1000 ( 0.8%)  wall=  12.2s  tps≈  670.1
[orchard][mac1_baseline-3_seq512_long] step 15/1000 ( 1.5%)  wall=  23.6s  tps≈  650.9
[orchard][mac1_baseline-3_seq512_long] step 22/1000 ( 2.2%)  wall=  34.1s  tps≈  661.3
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
[DEBUG][BASELINE] Output shape: torch.Size([2, 512, 768]), dtype: torch.bfloat16
