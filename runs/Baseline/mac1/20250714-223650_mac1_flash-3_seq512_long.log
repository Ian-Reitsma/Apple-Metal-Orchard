[orchard][flashpatch] FlashAttention monkeypatch ENABLED (GPT2Attention.forward, log=True, detail=False)
MPS available: True MPS built: True
[orchard] FlashAttention loaded (SHA e4dd5207…)
[orchard][flashpatch] --- FlashAttention Patch Context ---
  PATCH_ENABLED: True
  FLASHATTN_LOG_KERNEL: True
  FLASHATTN_LOG_DETAIL: False
  torch version: 2.7.1
  Model config (first layer): GPT2Config {
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 1024,
  "n_embd": 768,
  "n_head": 12,
  "n_inner": null,
  "n_layer": 12,
  "n_positions": 1024,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "torch_dtype": "float32",
  "transformers_version": "4.53.0",
  "use_cache": true,
  "vocab_size": 50257
}

  Example Q shape: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16, device: mps:0
  ENV: USE_FLASH_ATTN=1, PYTHONHASHSEED=None
-------------------------------------------------------------
`loss_type=None` was set in the config but it is unrecognised.Using the default loss: `ForCausalLMLoss`.
[orchard][mac1_flash-3_seq512_long] step 1/1000 ( 0.1%)  wall=   1.9s  tps≈  546.6
[orchard][mac1_flash-3_seq512_long] step 9/1000 ( 0.9%)  wall=  12.6s  tps≈  732.0
[orchard][mac1_flash-3_seq512_long] step 17/1000 ( 1.7%)  wall=  23.3s  tps≈  747.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 25/1000 ( 2.5%)  wall=  34.0s  tps≈  752.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 33/1000 ( 3.3%)  wall=  44.8s  tps≈  754.7
[orchard][mac1_flash-3_seq512_long] step 41/1000 ( 4.1%)  wall=  55.5s  tps≈  756.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 49/1000 ( 4.9%)  wall=  66.2s  tps≈  757.8
[orchard][mac1_flash-3_seq512_long] step 57/1000 ( 5.7%)  wall=  76.9s  tps≈  758.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 65/1000 ( 6.5%)  wall=  87.7s  tps≈  759.3
[orchard][mac1_flash-3_seq512_long] step 73/1000 ( 7.3%)  wall=  98.4s  tps≈  759.9
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 81/1000 ( 8.1%)  wall= 109.1s  tps≈  760.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 89/1000 ( 8.9%)  wall= 119.9s  tps≈  760.3
[orchard][mac1_flash-3_seq512_long] step 97/1000 ( 9.7%)  wall= 130.6s  tps≈  760.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 105/1000 (10.5%)  wall= 141.4s  tps≈  760.5
[orchard][mac1_flash-3_seq512_long] step 113/1000 (11.3%)  wall= 152.1s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 121/1000 (12.1%)  wall= 162.9s  tps≈  760.6
[orchard][mac1_flash-3_seq512_long] step 129/1000 (12.9%)  wall= 173.7s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 137/1000 (13.7%)  wall= 184.5s  tps≈  760.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 145/1000 (14.5%)  wall= 195.2s  tps≈  760.6
[orchard][mac1_flash-3_seq512_long] step 153/1000 (15.3%)  wall= 206.0s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 161/1000 (16.1%)  wall= 216.7s  tps≈  760.6
[orchard][mac1_flash-3_seq512_long] step 169/1000 (16.9%)  wall= 227.5s  tps≈  760.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 177/1000 (17.7%)  wall= 238.2s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 185/1000 (18.5%)  wall= 249.0s  tps≈  760.8
[orchard][mac1_flash-3_seq512_long] step 193/1000 (19.3%)  wall= 259.7s  tps≈  760.9
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 201/1000 (20.1%)  wall= 270.5s  tps≈  761.0
[orchard][mac1_flash-3_seq512_long] step 209/1000 (20.9%)  wall= 281.2s  tps≈  761.0
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 217/1000 (21.7%)  wall= 292.0s  tps≈  760.9
[orchard][mac1_flash-3_seq512_long] step 225/1000 (22.5%)  wall= 302.7s  tps≈  761.0
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 233/1000 (23.3%)  wall= 313.5s  tps≈  761.0
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 241/1000 (24.1%)  wall= 324.2s  tps≈  761.2
[orchard][mac1_flash-3_seq512_long] step 249/1000 (24.9%)  wall= 334.9s  tps≈  761.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 257/1000 (25.7%)  wall= 345.6s  tps≈  761.4
[orchard][mac1_flash-3_seq512_long] step 265/1000 (26.5%)  wall= 356.4s  tps≈  761.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 273/1000 (27.3%)  wall= 367.1s  tps≈  761.4
[orchard][mac1_flash-3_seq512_long] step 281/1000 (28.1%)  wall= 377.9s  tps≈  761.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 289/1000 (28.9%)  wall= 388.7s  tps≈  761.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 297/1000 (29.7%)  wall= 399.4s  tps≈  761.4
[orchard][mac1_flash-3_seq512_long] step 305/1000 (30.5%)  wall= 410.2s  tps≈  761.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 313/1000 (31.3%)  wall= 420.9s  tps≈  761.4
[orchard][mac1_flash-3_seq512_long] step 321/1000 (32.1%)  wall= 431.7s  tps≈  761.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 329/1000 (32.9%)  wall= 442.5s  tps≈  761.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 337/1000 (33.7%)  wall= 453.2s  tps≈  761.4
[orchard][mac1_flash-3_seq512_long] step 345/1000 (34.5%)  wall= 464.0s  tps≈  761.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 353/1000 (35.3%)  wall= 474.7s  tps≈  761.5
[orchard][mac1_flash-3_seq512_long] step 361/1000 (36.1%)  wall= 485.5s  tps≈  761.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 369/1000 (36.9%)  wall= 496.2s  tps≈  761.5
[orchard][mac1_flash-3_seq512_long] step 377/1000 (37.7%)  wall= 507.0s  tps≈  761.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 385/1000 (38.5%)  wall= 517.7s  tps≈  761.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 393/1000 (39.3%)  wall= 528.5s  tps≈  761.5
[orchard][mac1_flash-3_seq512_long] step 401/1000 (40.1%)  wall= 539.2s  tps≈  761.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 409/1000 (40.9%)  wall= 550.0s  tps≈  761.5
[orchard][mac1_flash-3_seq512_long] step 417/1000 (41.7%)  wall= 560.8s  tps≈  761.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 425/1000 (42.5%)  wall= 571.4s  tps≈  761.6
[orchard][mac1_flash-3_seq512_long] step 433/1000 (43.3%)  wall= 582.1s  tps≈  761.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 441/1000 (44.1%)  wall= 592.9s  tps≈  761.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 449/1000 (44.9%)  wall= 603.9s  tps≈  761.4
[orchard][mac1_flash-3_seq512_long] step 457/1000 (45.7%)  wall= 614.9s  tps≈  761.0
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 465/1000 (46.5%)  wall= 625.8s  tps≈  760.8
[orchard][mac1_flash-3_seq512_long] step 473/1000 (47.3%)  wall= 636.5s  tps≈  760.9
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 481/1000 (48.1%)  wall= 647.2s  tps≈  761.1
[orchard][mac1_flash-3_seq512_long] step 489/1000 (48.9%)  wall= 657.9s  tps≈  761.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 497/1000 (49.7%)  wall= 668.5s  tps≈  761.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 505/1000 (50.5%)  wall= 679.2s  tps≈  761.4
[orchard][mac1_flash-3_seq512_long] step 513/1000 (51.3%)  wall= 689.8s  tps≈  761.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 521/1000 (52.1%)  wall= 700.5s  tps≈  761.6
[orchard][mac1_flash-3_seq512_long] step 529/1000 (52.9%)  wall= 711.1s  tps≈  761.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 537/1000 (53.7%)  wall= 721.8s  tps≈  761.9
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 545/1000 (54.5%)  wall= 732.4s  tps≈  761.9
[orchard][mac1_flash-3_seq512_long] step 553/1000 (55.3%)  wall= 743.1s  tps≈  762.0
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 561/1000 (56.1%)  wall= 753.8s  tps≈  762.1
[orchard][mac1_flash-3_seq512_long] step 569/1000 (56.9%)  wall= 764.6s  tps≈  762.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 577/1000 (57.7%)  wall= 775.2s  tps≈  762.1
[orchard][mac1_flash-3_seq512_long] step 585/1000 (58.5%)  wall= 785.9s  tps≈  762.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 593/1000 (59.3%)  wall= 796.6s  tps≈  762.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 601/1000 (60.1%)  wall= 807.3s  tps≈  762.3
[orchard][mac1_flash-3_seq512_long] step 609/1000 (60.9%)  wall= 818.1s  tps≈  762.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 617/1000 (61.7%)  wall= 828.8s  tps≈  762.4
[orchard][mac1_flash-3_seq512_long] step 625/1000 (62.5%)  wall= 839.4s  tps≈  762.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 633/1000 (63.3%)  wall= 850.1s  tps≈  762.5
[orchard][mac1_flash-3_seq512_long] step 641/1000 (64.1%)  wall= 860.8s  tps≈  762.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 649/1000 (64.9%)  wall= 871.5s  tps≈  762.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 657/1000 (65.7%)  wall= 882.2s  tps≈  762.6
[orchard][mac1_flash-3_seq512_long] step 665/1000 (66.5%)  wall= 892.9s  tps≈  762.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 673/1000 (67.3%)  wall= 903.6s  tps≈  762.7
[orchard][mac1_flash-3_seq512_long] step 681/1000 (68.1%)  wall= 914.2s  tps≈  762.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 689/1000 (68.9%)  wall= 924.9s  tps≈  762.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 697/1000 (69.7%)  wall= 935.6s  tps≈  762.9
[orchard][mac1_flash-3_seq512_long] step 705/1000 (70.5%)  wall= 946.2s  tps≈  762.9
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 713/1000 (71.3%)  wall= 956.9s  tps≈  763.0
[orchard][mac1_flash-3_seq512_long] step 721/1000 (72.1%)  wall= 967.5s  tps≈  763.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 729/1000 (72.9%)  wall= 978.2s  tps≈  763.1
[orchard][mac1_flash-3_seq512_long] step 737/1000 (73.7%)  wall= 988.9s  tps≈  763.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 745/1000 (74.5%)  wall= 999.6s  tps≈  763.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 753/1000 (75.3%)  wall=1010.3s  tps≈  763.2
[orchard][mac1_flash-3_seq512_long] step 761/1000 (76.1%)  wall=1021.0s  tps≈  763.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 769/1000 (76.9%)  wall=1031.6s  tps≈  763.3
[orchard][mac1_flash-3_seq512_long] step 777/1000 (77.7%)  wall=1042.3s  tps≈  763.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 785/1000 (78.5%)  wall=1053.0s  tps≈  763.4
[orchard][mac1_flash-3_seq512_long] step 793/1000 (79.3%)  wall=1063.7s  tps≈  763.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 801/1000 (80.1%)  wall=1074.4s  tps≈  763.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 809/1000 (80.9%)  wall=1085.1s  tps≈  763.4
[orchard][mac1_flash-3_seq512_long] step 817/1000 (81.7%)  wall=1095.8s  tps≈  763.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 825/1000 (82.5%)  wall=1106.5s  tps≈  763.5
[orchard][mac1_flash-3_seq512_long] step 833/1000 (83.3%)  wall=1117.2s  tps≈  763.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 841/1000 (84.1%)  wall=1127.8s  tps≈  763.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 849/1000 (84.9%)  wall=1138.5s  tps≈  763.6
[orchard][mac1_flash-3_seq512_long] step 857/1000 (85.7%)  wall=1149.2s  tps≈  763.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 865/1000 (86.5%)  wall=1159.9s  tps≈  763.7
[orchard][mac1_flash-3_seq512_long] step 873/1000 (87.3%)  wall=1170.6s  tps≈  763.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 881/1000 (88.1%)  wall=1181.4s  tps≈  763.6
[orchard][mac1_flash-3_seq512_long] step 889/1000 (88.9%)  wall=1192.0s  tps≈  763.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 897/1000 (89.7%)  wall=1203.0s  tps≈  763.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 905/1000 (90.5%)  wall=1213.7s  tps≈  763.5
[orchard][mac1_flash-3_seq512_long] step 913/1000 (91.3%)  wall=1224.6s  tps≈  763.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 921/1000 (92.1%)  wall=1235.5s  tps≈  763.3
[orchard][mac1_flash-3_seq512_long] step 929/1000 (92.9%)  wall=1246.2s  tps≈  763.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 937/1000 (93.7%)  wall=1256.9s  tps≈  763.4
[orchard][mac1_flash-3_seq512_long] step 945/1000 (94.5%)  wall=1267.8s  tps≈  763.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 953/1000 (95.3%)  wall=1278.7s  tps≈  763.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 961/1000 (96.1%)  wall=1289.8s  tps≈  762.9
[orchard][mac1_flash-3_seq512_long] step 969/1000 (96.9%)  wall=1300.6s  tps≈  762.9
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 977/1000 (97.7%)  wall=1311.4s  tps≈  762.9
[orchard][mac1_flash-3_seq512_long] step 985/1000 (98.5%)  wall=1322.0s  tps≈  763.0
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[orchard][mac1_flash-3_seq512_long] step 993/1000 (99.3%)  wall=1332.7s  tps≈  763.0
[orchard][mac1_flash-3_seq512_long] step 1000/1000 (100.0%)  wall=1342.0s  tps≈  763.0
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
JSON:{"schema": "orchard_bench_v1", "tag": "mac1_flash-3_seq512_long", "commit": "53420a5", "dataset_sha": "57f3eb280cfe78d8cebe3aa76d7416607845416e22464dd9709ccb487f8d7b92", "batch": 2, "seq": 512, "micro_steps": 1000, "total_tokens": 1024000, "throughput_tps": 762.920423034407, "tokenize_s": 0.9086, "copy_s": 27.9139, "copy_mb_s": 0.29, "train_s": 0.0, "host_to_gpu_mb": 8.19, "avg_loss_stub": 0.5532580571686849, "max_grad": 168.0, "dtype": "torch.bfloat16", "bf16": true, "flash": {"enabled": true, "sha": "e4dd520784c547b9cebf18d82638e14937e4642232259047cf398a312d37822d", "built": "2025-07-12T23:47:23", "metal": "32023.620"}, "metal_ver": "32023.620", "seed": 42, "timeline": [], "avg_gpu_w": 6232.732531930879, "grad_accum": 1, "avg_gpu_temp": null}
