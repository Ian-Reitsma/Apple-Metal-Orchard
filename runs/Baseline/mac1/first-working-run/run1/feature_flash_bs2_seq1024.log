[orchard][flashpatch] FlashAttention monkeypatch ENABLED (GPT2Attention.forward, log=True, detail=False)
MPS available: True MPS built: True
[orchard] FlashAttention loaded (SHA e4dd5207…)
[orchard][flashpatch] --- FlashAttention Patch Context ---
  PATCH_ENABLED: True
  FLASHATTN_LOG_KERNEL: True
  FLASHATTN_LOG_DETAIL: False
  torch version: 2.7.1
  Model config (first layer): GPT2Config {
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 1024,
  "n_embd": 768,
  "n_head": 12,
  "n_inner": null,
  "n_layer": 12,
  "n_positions": 1024,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "torch_dtype": "float32",
  "transformers_version": "4.53.0",
  "use_cache": true,
  "vocab_size": 50257
}

  Example Q shape: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16, device: mps:0
  ENV: USE_FLASH_ATTN=1, PYTHONHASHSEED=None
-------------------------------------------------------------
`loss_type=None` was set in the config but it is unrecognised.Using the default loss: `ForCausalLMLoss`.
[orchard][feature_flash_bs2_seq1024] step 1/100 ( 1.0%)  wall=   3.8s  tps≈  532.3
[orchard][feature_flash_bs2_seq1024] step 3/100 ( 3.0%)  wall=  21.1s  tps≈  291.1
[orchard][feature_flash_bs2_seq1024] step 4/100 ( 4.0%)  wall=  33.3s  tps≈  246.4
[orchard][feature_flash_bs2_seq1024] step 5/100 ( 5.0%)  wall=  44.2s  tps≈  231.7
[orchard][feature_flash_bs2_seq1024] step 6/100 ( 6.0%)  wall=  54.6s  tps≈  224.9
[orchard][feature_flash_bs2_seq1024] step 7/100 ( 7.0%)  wall=  68.6s  tps≈  209.0
[orchard][feature_flash_bs2_seq1024] step 8/100 ( 8.0%)  wall=  85.0s  tps≈  192.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[orchard][feature_flash_bs2_seq1024] step 9/100 ( 9.0%)  wall= 101.7s  tps≈  181.2
[orchard][feature_flash_bs2_seq1024] step 10/100 (10.0%)  wall= 114.3s  tps≈  179.2
[orchard][feature_flash_bs2_seq1024] step 11/100 (11.0%)  wall= 132.4s  tps≈  170.1
[orchard][feature_flash_bs2_seq1024] step 12/100 (12.0%)  wall= 154.4s  tps≈  159.2
[orchard][feature_flash_bs2_seq1024] step 13/100 (13.0%)  wall= 176.2s  tps≈  151.1
[orchard][feature_flash_bs2_seq1024] step 14/100 (14.0%)  wall= 218.2s  tps≈  131.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[orchard][feature_flash_bs2_seq1024] step 15/100 (15.0%)  wall= 253.7s  tps≈  121.1
[orchard][feature_flash_bs2_seq1024] step 16/100 (16.0%)  wall= 295.7s  tps≈  110.8
[orchard][feature_flash_bs2_seq1024] step 17/100 (17.0%)  wall= 323.7s  tps≈  107.6
[orchard][feature_flash_bs2_seq1024] step 18/100 (18.0%)  wall= 353.6s  tps≈  104.2
[orchard][feature_flash_bs2_seq1024] step 19/100 (19.0%)  wall= 377.4s  tps≈  103.1
[orchard][feature_flash_bs2_seq1024] step 20/100 (20.0%)  wall= 410.1s  tps≈   99.9
[orchard][feature_flash_bs2_seq1024] step 21/100 (21.0%)  wall= 440.7s  tps≈   97.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[orchard][feature_flash_bs2_seq1024] step 22/100 (22.0%)  wall= 472.7s  tps≈   95.3
[orchard][feature_flash_bs2_seq1024] step 23/100 (23.0%)  wall= 494.5s  tps≈   95.2
[orchard][feature_flash_bs2_seq1024] step 24/100 (24.0%)  wall= 511.2s  tps≈   96.2
[orchard][feature_flash_bs2_seq1024] step 25/100 (25.0%)  wall= 525.2s  tps≈   97.5
[orchard][feature_flash_bs2_seq1024] step 26/100 (26.0%)  wall= 548.9s  tps≈   97.0
[orchard][feature_flash_bs2_seq1024] step 27/100 (27.0%)  wall= 576.8s  tps≈   95.9
[orchard][feature_flash_bs2_seq1024] step 28/100 (28.0%)  wall= 598.5s  tps≈   95.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[orchard][feature_flash_bs2_seq1024] step 29/100 (29.0%)  wall= 622.9s  tps≈   95.3
[orchard][feature_flash_bs2_seq1024] step 30/100 (30.0%)  wall= 647.6s  tps≈   94.9
[orchard][feature_flash_bs2_seq1024] step 31/100 (31.0%)  wall= 675.1s  tps≈   94.0
[orchard][feature_flash_bs2_seq1024] step 32/100 (32.0%)  wall= 715.8s  tps≈   91.6
[orchard][feature_flash_bs2_seq1024] step 33/100 (33.0%)  wall= 748.1s  tps≈   90.3
[orchard][feature_flash_bs2_seq1024] step 34/100 (34.0%)  wall= 794.5s  tps≈   87.6
[orchard][feature_flash_bs2_seq1024] step 35/100 (35.0%)  wall= 826.6s  tps≈   86.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[orchard][feature_flash_bs2_seq1024] step 36/100 (36.0%)  wall= 858.8s  tps≈   85.9
[orchard][feature_flash_bs2_seq1024] step 37/100 (37.0%)  wall= 892.1s  tps≈   84.9
[orchard][feature_flash_bs2_seq1024] step 38/100 (38.0%)  wall= 920.1s  tps≈   84.6
[orchard][feature_flash_bs2_seq1024] step 39/100 (39.0%)  wall= 952.7s  tps≈   83.8
[orchard][feature_flash_bs2_seq1024] step 40/100 (40.0%)  wall= 985.6s  tps≈   83.1
[orchard][feature_flash_bs2_seq1024] step 41/100 (41.0%)  wall=1019.5s  tps≈   82.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[orchard][feature_flash_bs2_seq1024] step 42/100 (42.0%)  wall=1044.3s  tps≈   82.4
[orchard][feature_flash_bs2_seq1024] step 43/100 (43.0%)  wall=1073.2s  tps≈   82.1
[orchard][feature_flash_bs2_seq1024] step 44/100 (44.0%)  wall=1094.7s  tps≈   82.3
[orchard][feature_flash_bs2_seq1024] step 45/100 (45.0%)  wall=1118.4s  tps≈   82.4
[orchard][feature_flash_bs2_seq1024] step 46/100 (46.0%)  wall=1140.0s  tps≈   82.6
[orchard][feature_flash_bs2_seq1024] step 47/100 (47.0%)  wall=1166.3s  tps≈   82.5
[orchard][feature_flash_bs2_seq1024] step 48/100 (48.0%)  wall=1195.7s  tps≈   82.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[orchard][feature_flash_bs2_seq1024] step 49/100 (49.0%)  wall=1217.5s  tps≈   82.4
[orchard][feature_flash_bs2_seq1024] step 50/100 (50.0%)  wall=1240.7s  tps≈   82.5
[orchard][feature_flash_bs2_seq1024] step 51/100 (51.0%)  wall=1275.6s  tps≈   81.9
[orchard][feature_flash_bs2_seq1024] step 52/100 (52.0%)  wall=1310.4s  tps≈   81.3
[orchard][feature_flash_bs2_seq1024] step 53/100 (53.0%)  wall=1338.0s  tps≈   81.1
[orchard][feature_flash_bs2_seq1024] step 54/100 (54.0%)  wall=1359.2s  tps≈   81.4
[orchard][feature_flash_bs2_seq1024] step 55/100 (55.0%)  wall=1387.5s  tps≈   81.2
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[orchard][feature_flash_bs2_seq1024] step 56/100 (56.0%)  wall=1413.0s  tps≈   81.2
[orchard][feature_flash_bs2_seq1024] step 57/100 (57.0%)  wall=1436.0s  tps≈   81.3
[orchard][feature_flash_bs2_seq1024] step 58/100 (58.0%)  wall=1469.7s  tps≈   80.8
[orchard][feature_flash_bs2_seq1024] step 59/100 (59.0%)  wall=1494.9s  tps≈   80.8
[orchard][feature_flash_bs2_seq1024] step 60/100 (60.0%)  wall=1517.8s  tps≈   81.0
[orchard][feature_flash_bs2_seq1024] step 61/100 (61.0%)  wall=1540.4s  tps≈   81.1
[orchard][feature_flash_bs2_seq1024] step 62/100 (62.0%)  wall=1571.7s  tps≈   80.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[orchard][feature_flash_bs2_seq1024] step 63/100 (63.0%)  wall=1597.1s  tps≈   80.8
[orchard][feature_flash_bs2_seq1024] step 64/100 (64.0%)  wall=1620.3s  tps≈   80.9
[orchard][feature_flash_bs2_seq1024] step 65/100 (65.0%)  wall=1648.6s  tps≈   80.7
[orchard][feature_flash_bs2_seq1024] step 66/100 (66.0%)  wall=1666.8s  tps≈   81.1
[orchard][feature_flash_bs2_seq1024] step 67/100 (67.0%)  wall=1695.0s  tps≈   81.0
[orchard][feature_flash_bs2_seq1024] step 68/100 (68.0%)  wall=1726.0s  tps≈   80.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[orchard][feature_flash_bs2_seq1024] step 69/100 (69.0%)  wall=1750.1s  tps≈   80.7
[orchard][feature_flash_bs2_seq1024] step 70/100 (70.0%)  wall=1769.7s  tps≈   81.0
[orchard][feature_flash_bs2_seq1024] step 71/100 (71.0%)  wall=1789.7s  tps≈   81.2
[orchard][feature_flash_bs2_seq1024] step 72/100 (72.0%)  wall=1816.4s  tps≈   81.2
[orchard][feature_flash_bs2_seq1024] step 73/100 (73.0%)  wall=1839.6s  tps≈   81.3
[orchard][feature_flash_bs2_seq1024] step 74/100 (74.0%)  wall=1876.3s  tps≈   80.8
[orchard][feature_flash_bs2_seq1024] step 75/100 (75.0%)  wall=1916.8s  tps≈   80.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[orchard][feature_flash_bs2_seq1024] step 76/100 (76.0%)  wall=1947.5s  tps≈   79.9
[orchard][feature_flash_bs2_seq1024] step 77/100 (77.0%)  wall=1980.4s  tps≈   79.6
[orchard][feature_flash_bs2_seq1024] step 78/100 (78.0%)  wall=2000.2s  tps≈   79.9
[orchard][feature_flash_bs2_seq1024] step 79/100 (79.0%)  wall=2022.6s  tps≈   80.0
[orchard][feature_flash_bs2_seq1024] step 80/100 (80.0%)  wall=2062.3s  tps≈   79.4
[orchard][feature_flash_bs2_seq1024] step 81/100 (81.0%)  wall=2097.5s  tps≈   79.1
[orchard][feature_flash_bs2_seq1024] step 82/100 (82.0%)  wall=2118.3s  tps≈   79.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[orchard][feature_flash_bs2_seq1024] step 83/100 (83.0%)  wall=2145.0s  tps≈   79.2
[orchard][feature_flash_bs2_seq1024] step 84/100 (84.0%)  wall=2170.9s  tps≈   79.2
[orchard][feature_flash_bs2_seq1024] step 85/100 (85.0%)  wall=2197.2s  tps≈   79.2
[orchard][feature_flash_bs2_seq1024] step 86/100 (86.0%)  wall=2222.7s  tps≈   79.2
[orchard][feature_flash_bs2_seq1024] step 87/100 (87.0%)  wall=2244.7s  tps≈   79.4
[orchard][feature_flash_bs2_seq1024] step 88/100 (88.0%)  wall=2268.2s  tps≈   79.5
[orchard][feature_flash_bs2_seq1024] step 89/100 (89.0%)  wall=2294.7s  tps≈   79.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[orchard][feature_flash_bs2_seq1024] step 90/100 (90.0%)  wall=2328.5s  tps≈   79.2
[orchard][feature_flash_bs2_seq1024] step 91/100 (91.0%)  wall=2355.4s  tps≈   79.1
[orchard][feature_flash_bs2_seq1024] step 92/100 (92.0%)  wall=2392.4s  tps≈   78.8
[orchard][feature_flash_bs2_seq1024] step 93/100 (93.0%)  wall=2422.8s  tps≈   78.6
[orchard][feature_flash_bs2_seq1024] step 94/100 (94.0%)  wall=2445.0s  tps≈   78.7
[orchard][feature_flash_bs2_seq1024] step 95/100 (95.0%)  wall=2466.9s  tps≈   78.9
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[orchard][feature_flash_bs2_seq1024] step 96/100 (96.0%)  wall=2490.2s  tps≈   79.0
[orchard][feature_flash_bs2_seq1024] step 97/100 (97.0%)  wall=2516.2s  tps≈   79.0
[orchard][feature_flash_bs2_seq1024] step 98/100 (98.0%)  wall=2548.0s  tps≈   78.8
[orchard][feature_flash_bs2_seq1024] step 99/100 (99.0%)  wall=2574.3s  tps≈   78.8
[orchard][feature_flash_bs2_seq1024] step 100/100 (100.0%)  wall=2595.5s  tps≈   78.9
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 1024, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 1024, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 1024, 768])
JSON:{"schema": "orchard_bench_v1", "tag": "feature_flash_bs2_seq1024", "commit": "5ba9243", "dataset_sha": "57f3eb280cfe78d8cebe3aa76d7416607845416e22464dd9709ccb487f8d7b92", "batch": 2, "seq": 1024, "micro_steps": 100, "total_tokens": 204800, "throughput_tps": 78.88626913288034, "tokenize_s": 6.201, "copy_s": 5.9468, "copy_mb_s": 0.28, "train_s": 0.0, "host_to_gpu_mb": 1.64, "avg_loss_stub": 0.5090358270704747, "max_grad": 166.0, "dtype": "torch.bfloat16", "bf16": true, "flash": {"enabled": true, "sha": "e4dd520784c547b9cebf18d82638e14937e4642232259047cf398a312d37822d", "built": "2025-07-12T23:47:23", "metal": "32023.620"}, "metal_ver": "32023.620", "seed": 42, "timeline": [], "avg_gpu_w": 625.8332038834951, "grad_accum": 1, "avg_gpu_temp": null}
