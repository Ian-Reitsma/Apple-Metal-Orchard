[orchard][flashpatch] FlashAttention monkeypatch ENABLED (GPT2Attention.forward, log=True, detail=False)
MPS available: True MPS built: True
[orchard] FlashAttention loaded (SHA e4dd5207…)
[orchard][flashpatch] --- FlashAttention Patch Context ---
  PATCH_ENABLED: True
  FLASHATTN_LOG_KERNEL: True
  FLASHATTN_LOG_DETAIL: False
  torch version: 2.7.1
  Model config (first layer): GPT2Config {
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 1024,
  "n_embd": 768,
  "n_head": 12,
  "n_inner": null,
  "n_layer": 12,
  "n_positions": 1024,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "torch_dtype": "float32",
  "transformers_version": "4.53.0",
  "use_cache": true,
  "vocab_size": 50257
}

  Example Q shape: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16, device: mps:0
  ENV: USE_FLASH_ATTN=1, PYTHONHASHSEED=None
-------------------------------------------------------------
`loss_type=None` was set in the config but it is unrecognised.Using the default loss: `ForCausalLMLoss`.
[orchard][feature_flash_bs2_seq512] step 1/100 ( 1.0%)  wall=   1.9s  tps≈  549.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][feature_flash_bs2_seq512] step 9/100 ( 9.0%)  wall=  12.6s  tps≈  730.5
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][feature_flash_bs2_seq512] step 17/100 (17.0%)  wall=  23.3s  tps≈  745.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][feature_flash_bs2_seq512] step 25/100 (25.0%)  wall=  34.1s  tps≈  750.4
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][feature_flash_bs2_seq512] step 33/100 (33.0%)  wall=  44.8s  tps≈  753.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][feature_flash_bs2_seq512] step 41/100 (41.0%)  wall=  55.5s  tps≈  756.3
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][feature_flash_bs2_seq512] step 49/100 (49.0%)  wall=  66.2s  tps≈  757.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][feature_flash_bs2_seq512] step 57/100 (57.0%)  wall=  77.0s  tps≈  758.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][feature_flash_bs2_seq512] step 65/100 (65.0%)  wall=  87.7s  tps≈  759.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][feature_flash_bs2_seq512] step 73/100 (73.0%)  wall=  98.4s  tps≈  759.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][feature_flash_bs2_seq512] step 81/100 (81.0%)  wall= 109.1s  tps≈  760.1
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][feature_flash_bs2_seq512] step 89/100 (89.0%)  wall= 119.8s  tps≈  760.6
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][feature_flash_bs2_seq512] step 97/100 (97.0%)  wall= 130.6s  tps≈  760.7
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[orchard][feature_flash_bs2_seq512] step 100/100 (100.0%)  wall= 134.6s  tps≈  760.8
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
[DEBUG][FLASHATTN] Output shape after kernel: torch.Size([2, 12, 512, 64]), dtype: torch.bfloat16
[DEBUG][AFTER PERMUTE] torch.Size([2, 512, 12, 64])
[DEBUG][AFTER RESHAPE] torch.Size([2, 512, 768])
JSON:{"schema": "orchard_bench_v1", "tag": "feature_flash_bs2_seq512", "commit": "5ba9243", "dataset_sha": "57f3eb280cfe78d8cebe3aa76d7416607845416e22464dd9709ccb487f8d7b92", "batch": 2, "seq": 512, "micro_steps": 100, "total_tokens": 102400, "throughput_tps": 759.8887783991773, "tokenize_s": 0.0995, "copy_s": 3.2248, "copy_mb_s": 0.25, "train_s": 0.0, "host_to_gpu_mb": 0.82, "avg_loss_stub": 0.8474702018499375, "max_grad": 168.0, "dtype": "torch.bfloat16", "bf16": true, "flash": {"enabled": true, "sha": "e4dd520784c547b9cebf18d82638e14937e4642232259047cf398a312d37822d", "built": "2025-07-12T23:47:23", "metal": "32023.620"}, "metal_ver": "32023.620", "seed": 42, "timeline": [], "avg_gpu_w": 5808.237226277372, "grad_accum": 1, "avg_gpu_temp": null}
